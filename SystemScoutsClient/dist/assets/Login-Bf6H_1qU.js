import{_ as U,r as o,C as h,b as k,d as f,e as s,z as q,g as z,h as c,i as A,y as I,F as x,k as T,t as D,n as E,u as M,E as O,B}from"./index-BPA1--Y9.js";import{I as V}from"./InputBase-BNv6Uapi.js";import{B as R}from"./BaseButton-DZplU3gx.js";import{A as _}from"./AppIcons-CRrJo_Hq.js";import{N as F}from"./NotificationToast-DncncPU9.js";const L={class:"login-page"},$={class:"login-header"},P={class:"login-title"},G={class:"password-row"},J=["aria-label","title"],Y={class:"actions-row"},H={class:"login-footer"},K={__name:"Login",setup(Q){const r=o(""),t=o(""),p=o(""),l=o(""),n=o(""),m=o(!1),u=o(!1),i=o({mensaje:"",tipo:""});let g=null;const w=o(null),v=o(!1);function y(a){i.value.mensaje!==a&&(i.value={mensaje:a,tipo:"error"}),g&&clearTimeout(g),g=setTimeout(()=>i.value={mensaje:"",tipo:""},2500)}async function b(a=!0){await B();const e=w.value?.$el?.querySelector?.(".base-field");if(e&&(e.focus(),a))try{e.select()}catch{}}function S(){v.value=!1,B(()=>{v.value=!0,setTimeout(()=>v.value=!1,500)})}h(r,()=>{l.value&&(l.value="")}),h(t,()=>{n.value&&(n.value="")});const C=M(),j=O(),N=async()=>{try{if(p.value="",l.value="",n.value="",m.value=!0,!r.value||!t.value){r.value||(l.value="Ingresa tu usuario"),t.value||(n.value="Ingresa tu contraseña");const a=!r.value&&!t.value?"Debes ingresar usuario y contraseña":"Completa los campos requeridos";y(a),b();return}if(r.value==="admin"&&t.value==="admin"){localStorage.setItem("token","demo-token-"+Date.now()),localStorage.setItem("currentUser",JSON.stringify({name:"Administrador",role:"Admin",avatarUrl:null}));const a=j.query.redirect||"/dashboard";C.push(a)}else{const a="Usuario y contraseña están equivocados";p.value=a,l.value="",n.value=a,y(a),t.value="",b(),S()}}catch(a){console.error(a);const e="Ocurrió un error al iniciar sesión";p.value=e,l.value="",n.value=e,y(e),b(!1)}finally{m.value=!1}};return(a,e)=>(f(),k("div",L,[s("div",{class:E(["login-card",{shake:v.value}])},[s("header",$,[s("div",P,[c(_,{name:"users",size:22}),e[4]||(e[4]=s("h1",null,"Ingreso al Sistema",-1))]),e[5]||(e[5]=s("p",{class:"login-subtitle"},"Autentícate con tu usuario y contraseña",-1))]),s("form",{class:"login-form",onSubmit:A(N,["prevent"])},[c(V,{ref_key:"usernameInputRef",ref:w,modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=d=>r.value=d),label:"Usuario",placeholder:"Tu usuario",required:"","external-error":l.value},null,8,["modelValue","external-error"]),s("div",G,[c(V,{modelValue:t.value,"onUpdate:modelValue":e[2]||(e[2]=d=>t.value=d),type:u.value?"text":"password",label:"Contraseña",placeholder:"Tu contraseña",required:"","external-error":n.value},{append:I(()=>[s("button",{type:"button",class:"append-btn","aria-label":u.value?"Ocultar contraseña":"Mostrar contraseña",title:u.value?"Ocultar":"Mostrar",onClick:e[1]||(e[1]=d=>u.value=!u.value)},[c(_,{name:u.value?"eye-off":"eye",size:18},null,8,["name"])],8,J)]),_:1},8,["modelValue","type","external-error"])]),s("div",Y,[c(R,{disabled:m.value,type:"submit",variant:"primary",size:"lg",block:""},{default:I(()=>[m.value?(f(),k(x,{key:1},[T(" Procesando... ")],64)):(f(),k(x,{key:0},[c(_,{name:"check",size:18}),e[6]||(e[6]=T(" Ingresar ",-1))],64))]),_:1},8,["disabled"])])],32),s("footer",H,[s("small",null,"© "+D(new Date().getFullYear())+" Guias y Scouts Biobío",1)]),i.value.mensaje?(f(),q(F,{key:0,message:i.value.mensaje,onClose:e[3]||(e[3]=d=>i.value.mensaje="")},null,8,["message"])):z("",!0)],2)]))}},se=U(K,[["__scopeId","data-v-6626cc6a"]]);export{se as default};
