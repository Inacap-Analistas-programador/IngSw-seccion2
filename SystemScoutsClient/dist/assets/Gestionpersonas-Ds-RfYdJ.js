import{I as T}from"./InputBase-Bn4M4T7r.js";import{B as U}from"./BaseSelect-Dr3xFzbM.js";import{B as k}from"./BaseButton-DbILRF5R.js";import{B as w}from"./BaseAlert-B4eZmxUy.js";import{B as F}from"./BaseModal-Cxz_boCF.js";import{_ as B,b as d,d as r,e,g as _,h as p,z as D,i as y,k as C,m as b,p as v,t as c,F as P,f as O,n as A,w as m,q as f,s as j,l as S}from"./index-DF_ZuZfT.js";const x=[],G={name:"GestionPersonas",components:{InputBase:T,BaseSelect:U,BaseButton:k,BaseAlert:w,BaseModal:F},data(){return{searchQuery:"",selectedRole:"",selectedRama:"",selectedCourse:"",roleOptions:[{value:"",label:"Todos los roles"},{value:"PARTICIPANTE",label:"Participante"},{value:"DIRIGENTE",label:"Dirigente"},{value:"APOYO",label:"Apoyo"}],ramaOptions:[{value:"",label:"Todas las ramas"},{value:"CASTORES",label:"Castores"},{value:"LOBATOS",label:"Lobatos"},{value:"SCOUTS",label:"Scouts"},{value:"PIONEROS",label:"Pioneros"},{value:"ROVERS",label:"Rovers"}],courseOptions:[{value:"",label:"Todos los cursos"},{value:"PRIMEROS_AUXILIOS",label:"Primeros Auxilios (RCP y Soporte Vital)"},{value:"ORIENTACION_NAV",label:"Orientación y Navegación"},{value:"CAMPAMENTOS",label:"Campamentos y Técnicas de Campo"},{value:"LIDERAZGO_SCOUT",label:"Liderazgo Scout"},{value:"FORMACION_DIRIGENTES",label:"Formación de Dirigentes"}],personaSeleccionada:null,editModalVisible:!1,personaEditada:null,modalTab:"info",modoSoloLectura:!1,confirmModalVisible:!1,mensajeConfirmacion:"",confirmModalAnularVisible:!1,personaAAnular:null,esAdministrador:!0,filtroAplicado:!1,filteredPersonas:[],filtrandoEnProceso:!1,personas:[]}},created(){this.personas=x,this.enrichPersonas()},computed:{filtrosActivos(){const t=[];if(this.searchQuery&&this.searchQuery.trim()&&t.push(`Búsqueda: "${this.searchQuery.trim()}"`),this.selectedRole){const o=this.roleOptions.find(l=>l.value===this.selectedRole)?.label||this.selectedRole;t.push(`Rol: ${o}`)}if(this.selectedRama){const o=this.ramaOptions.find(l=>l.value===this.selectedRama)?.label||this.selectedRama;t.push(`Rama: ${o}`)}if(this.selectedCourse){const o=this.courseOptions.find(l=>l.value===this.selectedCourse)?.label||this.selectedCourse;t.push(`Curso: ${o}`)}return t},filtroMensaje(){const t=this.filtrosActivos;return t.length===0?"":t.length===1?`Filtro activo: ${t[0]}`:`Filtros activos: ${t.join(" | ")}`},personasFiltradas(){return this.filteredPersonas||[]}},methods:{seleccionar(t){this.abrirModal(t)},abrirModal(t){this.personaEditada=JSON.parse(JSON.stringify(t||{})),this.personaEditada.historial||(this.personaEditada.historial=[]),this.newHistEntry={fecha:"",descripcion:""},this.modalTab="info",this.editModalVisible=!0,this.personaSeleccionada=t,this.pendingSave=!1},abrirModalVer(t){this.personaEditada=JSON.parse(JSON.stringify(t||{})),this.personaEditada.historial||(this.personaEditada.historial=[]),this.modalTab="info",this.modoSoloLectura=!0,this.editModalVisible=!0,this.personaSeleccionada=t,this.pendingSave=!1},abrirModalEditar(t){this.personaEditada=JSON.parse(JSON.stringify(t||{})),this.personaEditada.historial||(this.personaEditada.historial=[]),this.newHistEntry={fecha:"",descripcion:""},this.modalTab="info",this.modoSoloLectura=!1,this.editModalVisible=!0,this.personaSeleccionada=t,this.pendingSave=!1},cancelarEdicion(){this.editModalVisible=!1,this.personaEditada=null,this.personaSeleccionada=null,this.pendingSave=!1},cerrarDetalle(){this.personaSeleccionada=null},filtrar(){this.filtrandoEnProceso||(this.filtrandoEnProceso=!0,setTimeout(()=>{this.ejecutarFiltrado(),this.filtrandoEnProceso=!1},10))},ejecutarFiltrado(){const t=(this.searchQuery||"").toLowerCase().trim(),o=(this.selectedRole||"").toString().trim().toUpperCase(),l=(this.selectedRama||"").toString().trim().toUpperCase(),E=(this.selectedCourse||"").toString().trim().toUpperCase();if(!(t||o||l||E)){alert("Debe usar un filtro o mas para poder buscar.");return}this.filtroAplicado=!0,this.personaSeleccionada=null,this.filteredPersonas=this.personas.filter(i=>{const h=(i.nombre||"").toLowerCase(),n=(i.rut||"").toLowerCase(),u=(i.email||"").toLowerCase(),R=h.includes(t)||n.includes(t)||u.includes(t),a=(i.rol||"").toString().trim().toUpperCase(),g=(i.rama||"").toString().trim().toUpperCase(),N=(i.cursos||[]).map(L=>(""+L).toString().trim().toUpperCase()),V=o?a===o:!0,I=l?g===l:!0,M=E?N.includes(E):!0;return R&&V&&I&&M}),this.$nextTick(()=>{const i=document.querySelector(".table-wrapper");i&&typeof i.scrollIntoView=="function"&&i.scrollIntoView({behavior:"smooth",block:"start"})})},enrichPersonas(){const t=new Date().toISOString();this.personas=(this.personas||[]).map((o,l)=>{const E=(o.rut||"").toString().trim();let s=null,i="";const h=E.match(/([0-9\.]+)-?([0-9kK])/);h&&(s=Number(h[1].replace(/\./g,""))||null,i=h[2]||"");const n=(o.nombre||"").toString().trim().split(/\s+/);let u="",R="",a=o.nombre||"";return n.length>=2&&(u=n[n.length-2]||"",R=n[n.length-1]||"",a=n.slice(0,n.length-2).join(" ")||a),Object.assign({},o,{PER_ID:l+1,ESC_ID:null,COM_ID:null,USU_ID:null,PER_FECHA_HORA:t,PER_RUN:s,PER_DV:i,PER_APELPAT:u,PER_APELMAT:R,PER_NOMBRES:a||o.nombre,PER_EMAIL:o.email||"",PER_FECHA_NAC:o.fecha_nac||"1990-01-01",PER_DIRECCION:o.direccion||"",PER_TIPO_FONO:"Móvil",PER_FONO:o.telefono||"",PER_ALERGIA_ENFERMEDAD:o.alergias||"",PER_LIMITACION:o.limitacion||"",PER_NOM_EMERGENCIA:o.contacto_emergencia||"",PER_FONO_EMERGENCIA:o.telefono_emergencia||"",PER_OTROS:o.otros||"",PER_NUM_MMAA:o.num_mmaa||0,PER_PROFESION:o.profesion||"",PER_TIEMPO_NNAJ:o.tiempo_nnaj||"",PER_TIEMPO_ADULTO:o.tiempo_adulto||"",PER_RELIGION:o.religion||"",PER_APODO:o.apodo||"",PER_FOTO:o.foto||null,PER_VIGENTE:o.vigente===void 0?!0:!!o.vigente,cursos:o.cursos||[],historial:o.historial||[]})})},exportarExcel(){const t=this.personasFiltradas.map(n=>({Nombre:n.nombre,RUT:n.rut,Email:n.email,Rol:n.rol,Rama:n.rama,Grupo:n.grupo,Estado:n.estado})),o=t.length?Object.keys(t[0]):["Nombre","RUT","Email","Rol","Rama","Grupo","Estado"],l=[];l.push(o.join(","));for(const n of t){const u=o.map(R=>{const a=n[R]??"";return`"${String(a).replace(/"/g,'""')}"`});l.push(u.join(","))}const E=l.join(`\r
`),s=new Blob([E],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(s),h=document.createElement("a");h.href=i,h.setAttribute("download","GestionPersonas.csv"),document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(i)},guardarEdicion(){if(!this.personaEditada||!this.personaEditada.rut||!this.personaEditada.nombre){alert("Nombre y RUT son obligatorios");return}this.mensajeConfirmacion="¿Seguro que quieres guardar estos cambios?",this.confirmModalVisible=!0},confirmarGuardado(){this.confirmModalVisible=!1,this.personaEditada&&(this.personaEditada.PER_FECHA_NAC=this.personaEditada.fecha_nac||this.personaEditada.PER_FECHA_NAC||"",this.personaEditada.PER_DIRECCION=this.personaEditada.direccion||this.personaEditada.PER_DIRECCION||"",this.personaEditada.PER_NOM_EMERGENCIA=this.personaEditada.contacto_emergencia||this.personaEditada.PER_NOM_EMERGENCIA||"",this.personaEditada.PER_FONO_EMERGENCIA=this.personaEditada.telefono_emergencia||this.personaEditada.PER_FONO_EMERGENCIA||"",this.personaEditada.PER_ALERGIA_ENFERMEDAD=this.personaEditada.alergias||this.personaEditada.PER_ALERGIA_ENFERMEDAD||"",this.personaEditada.PER_LIMITACION=this.personaEditada.limitacion||this.personaEditada.PER_LIMITACION||"",this.personaEditada.PER_APODO=this.personaEditada.apodo||this.personaEditada.PER_APODO||"",this.personaEditada.PER_RELIGION=this.personaEditada.religion||this.personaEditada.PER_RELIGION||"",this.personaEditada.PER_TIEMPO_NNAJ=this.personaEditada.tiempo_nnaj||this.personaEditada.PER_TIEMPO_NNAJ||"",this.personaEditada.PER_TIEMPO_ADULTO=this.personaEditada.tiempo_adulto||this.personaEditada.PER_TIEMPO_ADULTO||"",this.personaEditada.PER_VIGENTE=this.personaEditada.vigente===void 0?this.personaEditada.PER_VIGENTE??!0:!!this.personaEditada.vigente);const t=this.personas.findIndex(o=>o.rut===this.personaEditada.rut);if(t!==-1)this.$set?this.$set(this.personas,t,Object.assign({},this.personaEditada)):this.personas.splice(t,1,Object.assign({},this.personaEditada));else{const o=this.personaSeleccionada&&this.personaSeleccionada.rut,l=this.personas.findIndex(E=>E.rut===o);l!==-1&&this.personas.splice(l,1,Object.assign({},this.personaEditada))}if(this.filteredPersonas&&this.filteredPersonas.length){const o=this.filteredPersonas.findIndex(l=>l.rut===this.personaEditada.rut);if(o!==-1)this.filteredPersonas.splice(o,1,Object.assign({},this.personaEditada));else{const l=this.personaSeleccionada&&this.personaSeleccionada.rut,E=this.filteredPersonas.findIndex(s=>s.rut===l);E!==-1&&this.filteredPersonas.splice(E,1,Object.assign({},this.personaEditada))}}this.editModalVisible=!1,this.personaSeleccionada=null,this.personaEditada=null},cancelarConfirmacion(){this.confirmModalVisible=!1},anularPersona(t){this.personaAAnular=t,this.confirmModalAnularVisible=!0},cancelarAnulacion(){this.confirmModalAnularVisible=!1,this.personaAAnular=null},confirmarAnulacion(){if(!this.personaAAnular)return;this.personaAAnular.estado="Anulado",this.personaAAnular.inscripcion="Anulado",this.personaAAnular.vigente=!1;const t=this.personas.findIndex(o=>o.rut===this.personaAAnular.rut);if(t!==-1&&(this.$set?this.$set(this.personas,t,Object.assign({},this.personaAAnular)):this.personas.splice(t,1,Object.assign({},this.personaAAnular))),this.filteredPersonas&&this.filteredPersonas.length){const o=this.filteredPersonas.findIndex(l=>l.rut===this.personaAAnular.rut);o!==-1&&this.filteredPersonas.splice(o,1,Object.assign({},this.personaAAnular))}this.confirmModalAnularVisible=!1,this.personaAAnular=null},addHistEntry(){if(!this.personaEditada)return;const t=(this.newHistEntry.fecha||"").trim(),o=(this.newHistEntry.descripcion||"").trim();if(!t||!o){alert("Fecha y descripción son obligatorias para agregar al historial");return}this.personaEditada.historial=this.personaEditada.historial||[],this.personaEditada.historial.unshift({fecha:t,descripcion:o}),this.newHistEntry={fecha:"",descripcion:""}},getCursoLabel(t){const o=this.courseOptions.find(l=>l.value===t);return o?o.label:t},handleFileUpload(t){const o=t.target.files[0];if(!o)return;if(!o.type.startsWith("image/")){alert("Por favor selecciona un archivo de imagen válido.");return}if(o.size>5*1024*1024){alert("El archivo es demasiado grande. Por favor selecciona una imagen menor a 5MB.");return}const l=new FileReader;l.onload=E=>{this.personaEditada.foto=E.target.result},l.readAsDataURL(o)},removePhoto(){this.personaEditada.foto=null},handleImageError(){this.personaEditada.foto=null}}},H={class:"gestion-personas"},q={class:"filtros"},J={class:"filtros-left"},Q={class:"filtros-right"},z={key:0,class:"filtro-activo",role:"status","aria-live":"polite"},K={class:"main-area"},W={key:0,class:"table-wrapper"},X={"data-label":"Nombre"},Y={"data-label":"RUT"},Z={"data-label":"Email"},$={"data-label":"Rol"},oo={"data-label":"Rama"},eo={"data-label":"Grupo"},so={"data-label":"Estado"},ao={class:"acciones-buttons"},to={key:0,class:"placeholder-row"},io={key:1,class:"no-filtro",style:{padding:"32px","text-align":"center",color:"#666"}},lo={class:"modal-edit"},no={class:"modal-header"},ro={key:0,class:"header-actions"},uo={class:"modal-tabs"},po={class:"foto-perfil-section"},co={class:"foto-container"},mo=["src","alt"],Eo={key:1,class:"foto-placeholder"},fo={key:2,class:"foto-actions"},ho={class:"row"},bo=["readonly"],vo={class:"row"},Ro=["readonly"],Ao={class:"row"},_o=["readonly"],go={class:"row"},Co=["readonly"],yo={class:"row"},Po=["readonly"],Oo={class:"row"},So=["readonly"],No={class:"row"},Vo=["readonly"],Io={class:"row"},Mo=["readonly"],Lo={class:"row"},To=["readonly"],Uo={class:"row"},ko=["readonly"],wo={class:"row"},Fo=["readonly"],Bo={class:"row"},Do=["readonly"],jo={class:"row"},xo=["readonly"],Go={class:"row"},Ho=["readonly"],qo={class:"row"},Jo=["readonly"],Qo={class:"row"},zo=["disabled"],Ko={class:"row"},Wo={class:"row"},Xo={class:"hist-list"},Yo={key:0},Zo={key:0,class:"historial-curso"},$o={class:"confirm-content"},oe={class:"confirm-actions"},ee={class:"confirm-content"},se={class:"confirm-actions"};function ae(t,o,l,E,s,i){const h=C("InputBase"),n=C("BaseSelect"),u=C("BaseButton"),R=C("BaseModal");return r(),d("div",H,[e("div",q,[e("div",J,[p(h,{modelValue:s.searchQuery,"onUpdate:modelValue":o[0]||(o[0]=a=>s.searchQuery=a),placeholder:"Buscar por nombre, RUT, email...",onKeydown:D(y(i.filtrar,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),p(n,{modelValue:s.selectedRole,"onUpdate:modelValue":o[1]||(o[1]=a=>s.selectedRole=a),options:s.roleOptions,placeholder:"Todos los roles"},null,8,["modelValue","options"]),p(n,{modelValue:s.selectedCourse,"onUpdate:modelValue":o[2]||(o[2]=a=>s.selectedCourse=a),options:s.courseOptions,placeholder:"Todos los cursos"},null,8,["modelValue","options"]),p(n,{modelValue:s.selectedRama,"onUpdate:modelValue":o[3]||(o[3]=a=>s.selectedRama=a),options:s.ramaOptions,placeholder:"Todas las ramas"},null,8,["modelValue","options"])]),e("div",Q,[p(u,{class:"btn-search",variant:"primary",onClick:i.filtrar},{default:b(()=>[...o[32]||(o[32]=[v("🔎 Buscar",-1)])]),_:1},8,["onClick"]),p(u,{class:"btn-export",variant:"secondary",onClick:i.exportarExcel},{default:b(()=>[...o[33]||(o[33]=[v("📊 Exportar",-1)])]),_:1},8,["onClick"])])]),s.filtroAplicado&&i.filtrosActivos.length>0?(r(),d("div",z,c(i.filtroMensaje),1)):_("",!0),e("div",K,[s.filtroAplicado?(r(),d("div",W,[e("table",null,[o[38]||(o[38]=e("thead",null,[e("tr",null,[e("th",null,"Nombre"),e("th",null,"RUT"),e("th",null,"Email"),e("th",null,"Rol"),e("th",null,"Rama"),e("th",null,"Grupo"),e("th",null,"Estado"),e("th",null,"Acciones")])],-1)),e("tbody",null,[(r(!0),d(P,null,O(i.personasFiltradas,a=>(r(),d("tr",{key:a.rut,class:A({"persona-anulada":a.estado==="Anulado"})},[e("td",X,c(a.nombre),1),e("td",Y,c(a.rut),1),e("td",Z,c(a.email),1),e("td",$,c(a.rol),1),e("td",oo,c(a.rama),1),e("td",eo,c(a.grupo),1),e("td",so,[e("span",{class:A(["estado",a.estado.toLowerCase().replace(/\s+/g,"-")])},c(a.estado),3)]),e("td",null,[e("div",ao,[p(u,{class:"btn-ver btn-view",variant:"info",onClick:g=>i.abrirModalVer(a)},{default:b(()=>[...o[34]||(o[34]=[v("Ver",-1)])]),_:1},8,["onClick"]),s.esAdministrador?(r(),S(u,{key:0,class:"btn-editar btn-edit",variant:"secondary",onClick:g=>i.abrirModalEditar(a)},{default:b(()=>[...o[35]||(o[35]=[v(" Editar ",-1)])]),_:1},8,["onClick"])):_("",!0),s.esAdministrador?(r(),S(u,{key:1,class:"btn-anular btn-cancel",variant:"warning",onClick:g=>i.anularPersona(a)},{default:b(()=>[...o[36]||(o[36]=[v(" Anular ",-1)])]),_:1},8,["onClick"])):_("",!0)])])],2))),128)),i.personasFiltradas.length===0?(r(),d("tr",to,[...o[37]||(o[37]=[e("td",{"data-label":"Nombre",colspan:"8"},"No hay participantes para mostrar",-1)])])):_("",!0)])])])):(r(),d("div",io,' Aplica filtros y presiona "Buscar" para ver la lista de personas. ')),p(R,{modelValue:s.editModalVisible,"onUpdate:modelValue":o[29]||(o[29]=a=>s.editModalVisible=a),onClose:i.cancelarEdicion},{default:b(()=>[e("div",lo,[e("header",no,[e("h3",null,c(s.modoSoloLectura?"Ver":"Editar")+" - "+c(s.personaEditada?.nombre||""),1),s.modoSoloLectura?_("",!0):(r(),d("div",ro,[p(u,{class:"btn-save",type:"button",variant:"primary",onClick:i.guardarEdicion},{default:b(()=>[...o[39]||(o[39]=[v("💾 Guardar",-1)])]),_:1},8,["onClick"])]))]),e("div",uo,[e("button",{class:A({active:s.modalTab==="info"}),onClick:o[4]||(o[4]=a=>s.modalTab="info")},"Info",2),e("button",{class:A({active:s.modalTab==="hist"}),onClick:o[5]||(o[5]=a=>s.modalTab="hist")},"Historial",2)]),s.modalTab==="info"?(r(),d("form",{key:0,onSubmit:o[28]||(o[28]=y((...a)=>i.guardarEdicion&&i.guardarEdicion(...a),["prevent"])),class:"modal-form"},[e("div",po,[e("div",co,[s.personaEditada.foto?(r(),d("img",{key:0,src:s.personaEditada.foto,alt:`Foto de ${s.personaEditada.nombre}`,class:"foto-perfil",onError:o[6]||(o[6]=(...a)=>i.handleImageError&&i.handleImageError(...a))},null,40,mo)):(r(),d("div",Eo,[...o[40]||(o[40]=[e("span",{class:"foto-icon"},"👤",-1),e("span",{class:"foto-text"},"Sin foto",-1)])])),s.modoSoloLectura?_("",!0):(r(),d("div",fo,[e("input",{ref:"fotoInput",type:"file",accept:"image/*",onChange:o[7]||(o[7]=(...a)=>i.handleFileUpload&&i.handleFileUpload(...a)),style:{display:"none"}},null,544),e("button",{type:"button",onClick:o[8]||(o[8]=a=>t.$refs.fotoInput?.click()),class:"btn-foto-upload"}," 📷 "+c(s.personaEditada.foto?"Cambiar":"Subir")+" Foto ",1),s.personaEditada.foto?(r(),d("button",{key:0,type:"button",onClick:o[9]||(o[9]=(...a)=>i.removePhoto&&i.removePhoto(...a)),class:"btn-foto-remove"}," 🗑️ Eliminar ")):_("",!0)]))])]),e("div",ho,[o[41]||(o[41]=e("label",null,"Nombre",-1)),m(e("input",{"onUpdate:modelValue":o[10]||(o[10]=a=>s.personaEditada.nombre=a),readonly:s.modoSoloLectura,required:""},null,8,bo),[[f,s.personaEditada.nombre]])]),e("div",vo,[o[42]||(o[42]=e("label",null,"RUT",-1)),m(e("input",{"onUpdate:modelValue":o[11]||(o[11]=a=>s.personaEditada.rut=a),readonly:s.modoSoloLectura,required:""},null,8,Ro),[[f,s.personaEditada.rut]])]),e("div",Ao,[o[43]||(o[43]=e("label",null,"Email",-1)),m(e("input",{"onUpdate:modelValue":o[12]||(o[12]=a=>s.personaEditada.email=a),readonly:s.modoSoloLectura,type:"email"},null,8,_o),[[f,s.personaEditada.email]])]),e("div",go,[o[44]||(o[44]=e("label",null,"Teléfono",-1)),m(e("input",{"onUpdate:modelValue":o[13]||(o[13]=a=>s.personaEditada.telefono=a),readonly:s.modoSoloLectura},null,8,Co),[[f,s.personaEditada.telefono]])]),e("div",yo,[o[45]||(o[45]=e("label",null,"Profesión",-1)),m(e("input",{"onUpdate:modelValue":o[14]||(o[14]=a=>s.personaEditada.profesion=a),readonly:s.modoSoloLectura},null,8,Po),[[f,s.personaEditada.profesion]])]),e("div",Oo,[o[46]||(o[46]=e("label",null,"Fecha Nac.",-1)),m(e("input",{"onUpdate:modelValue":o[15]||(o[15]=a=>s.personaEditada.fecha_nac=a),readonly:s.modoSoloLectura,type:"date"},null,8,So),[[f,s.personaEditada.fecha_nac]])]),e("div",No,[o[47]||(o[47]=e("label",null,"Dirección",-1)),m(e("input",{"onUpdate:modelValue":o[16]||(o[16]=a=>s.personaEditada.direccion=a),readonly:s.modoSoloLectura},null,8,Vo),[[f,s.personaEditada.direccion]])]),e("div",Io,[o[48]||(o[48]=e("label",null,"Contacto Emerg.",-1)),m(e("input",{"onUpdate:modelValue":o[17]||(o[17]=a=>s.personaEditada.contacto_emergencia=a),readonly:s.modoSoloLectura},null,8,Mo),[[f,s.personaEditada.contacto_emergencia]])]),e("div",Lo,[o[49]||(o[49]=e("label",null,"Tel. Emerg.",-1)),m(e("input",{"onUpdate:modelValue":o[18]||(o[18]=a=>s.personaEditada.telefono_emergencia=a),readonly:s.modoSoloLectura},null,8,To),[[f,s.personaEditada.telefono_emergencia]])]),e("div",Uo,[o[50]||(o[50]=e("label",null,"Alergias",-1)),m(e("input",{"onUpdate:modelValue":o[19]||(o[19]=a=>s.personaEditada.alergias=a),readonly:s.modoSoloLectura},null,8,ko),[[f,s.personaEditada.alergias]])]),e("div",wo,[o[51]||(o[51]=e("label",null,"Limitación",-1)),m(e("input",{"onUpdate:modelValue":o[20]||(o[20]=a=>s.personaEditada.limitacion=a),readonly:s.modoSoloLectura},null,8,Fo),[[f,s.personaEditada.limitacion]])]),e("div",Bo,[o[52]||(o[52]=e("label",null,"Apodo",-1)),m(e("input",{"onUpdate:modelValue":o[21]||(o[21]=a=>s.personaEditada.apodo=a),readonly:s.modoSoloLectura},null,8,Do),[[f,s.personaEditada.apodo]])]),e("div",jo,[o[53]||(o[53]=e("label",null,"Religión",-1)),m(e("input",{"onUpdate:modelValue":o[22]||(o[22]=a=>s.personaEditada.religion=a),readonly:s.modoSoloLectura},null,8,xo),[[f,s.personaEditada.religion]])]),e("div",Go,[o[54]||(o[54]=e("label",null,"Tiempo NNAJ",-1)),m(e("input",{"onUpdate:modelValue":o[23]||(o[23]=a=>s.personaEditada.tiempo_nnaj=a),readonly:s.modoSoloLectura},null,8,Ho),[[f,s.personaEditada.tiempo_nnaj]])]),e("div",qo,[o[55]||(o[55]=e("label",null,"Tiempo Adulto",-1)),m(e("input",{"onUpdate:modelValue":o[24]||(o[24]=a=>s.personaEditada.tiempo_adulto=a),readonly:s.modoSoloLectura},null,8,Jo),[[f,s.personaEditada.tiempo_adulto]])]),e("div",Qo,[o[57]||(o[57]=e("label",null,"Vigente",-1)),m(e("select",{"onUpdate:modelValue":o[25]||(o[25]=a=>s.personaEditada.vigente=a),disabled:s.modoSoloLectura},[...o[56]||(o[56]=[e("option",{value:!0},"Si",-1),e("option",{value:!1},"No",-1)])],8,zo),[[j,s.personaEditada.vigente]])]),e("div",Ko,[o[58]||(o[58]=e("label",null,"Rol",-1)),p(n,{modelValue:s.personaEditada.rol,"onUpdate:modelValue":o[26]||(o[26]=a=>s.personaEditada.rol=a),options:s.roleOptions,disabled:s.modoSoloLectura},null,8,["modelValue","options","disabled"])]),e("div",Wo,[o[59]||(o[59]=e("label",null,"Rama",-1)),p(n,{modelValue:s.personaEditada.rama,"onUpdate:modelValue":o[27]||(o[27]=a=>s.personaEditada.rama=a),options:s.ramaOptions,disabled:s.modoSoloLectura},null,8,["modelValue","options","disabled"])])],32)):(r(),d("div",{key:1,class:A(["historial-panel",{"historial-anulado":s.personaEditada.estado==="Anulado"}])},[e("div",Xo,[(s.personaEditada.historial||[]).length===0?(r(),d("div",Yo,"No hay participaciones previas.")):_("",!0),e("ul",null,[(r(!0),d(P,null,O(s.personaEditada.historial||[],(a,g)=>(r(),d("li",{key:g,class:A(["historial-item",{"historial-item-anulado":s.personaEditada.estado==="Anulado"}])},[e("div",{class:A(["historial-content",{"historial-content-anulado":s.personaEditada.estado==="Anulado"}])},[e("div",{class:A(["historial-main",{"historial-main-anulado":s.personaEditada.estado==="Anulado"}])},[e("strong",null,c(a.fecha),1),v(": "+c(a.descripcion),1)],2),a.curso?(r(),d("div",Zo,[e("span",{class:A(["curso-badge",{"curso-badge-anulado":s.personaEditada.estado==="Anulado"}])},c(i.getCursoLabel(a.curso)),3),e("span",{class:A(["aprobacion-badge",a.aprobado?"aprobado":"no-aprobado",{"aprobacion-badge-anulado":s.personaEditada.estado==="Anulado"}])},c(a.aprobado?"✅ Aprobado":"❌ No Aprobado"),3)])):_("",!0)],2)],2))),128))])])],2))])]),_:1},8,["modelValue","onClose"]),p(R,{modelValue:s.confirmModalVisible,"onUpdate:modelValue":o[30]||(o[30]=a=>s.confirmModalVisible=a),title:"Confirmar Cambios"},{default:b(()=>[e("div",$o,[o[62]||(o[62]=e("div",{class:"confirm-icon"},"⚠️",-1)),e("p",null,c(s.mensajeConfirmacion),1),e("div",oe,[p(u,{onClick:i.cancelarConfirmacion,variant:"secondary",class:"btn-modal-cancel"},{default:b(()=>[...o[60]||(o[60]=[v(" ❌ Cancelar ",-1)])]),_:1},8,["onClick"]),p(u,{onClick:i.confirmarGuardado,variant:"primary",class:"btn-modal-confirm"},{default:b(()=>[...o[61]||(o[61]=[v(" ✅ Confirmar ",-1)])]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"]),p(R,{modelValue:s.confirmModalAnularVisible,"onUpdate:modelValue":o[31]||(o[31]=a=>s.confirmModalAnularVisible=a),title:"Confirmar Anulación"},{default:b(()=>[e("div",ee,[o[67]||(o[67]=e("div",{class:"confirm-icon"},"⚠️",-1)),e("p",null,[o[63]||(o[63]=v("¿Estás seguro de que deseas anular a ",-1)),e("strong",null,c(s.personaAAnular?.nombre),1),o[64]||(o[64]=v("?",-1))]),o[68]||(o[68]=e("p",{class:"confirm-warning"},"Esta acción marcará a la persona en gris y cambiará su estado.",-1)),e("div",se,[p(u,{onClick:i.cancelarAnulacion,variant:"secondary",class:"btn-modal-cancel"},{default:b(()=>[...o[65]||(o[65]=[v(" ❌ Cancelar ",-1)])]),_:1},8,["onClick"]),p(u,{onClick:i.confirmarAnulacion,variant:"warning",class:"btn-modal-anular"},{default:b(()=>[...o[66]||(o[66]=[v(" ⚠️ Anular ",-1)])]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"])])])}const ue=B(G,[["render",ae],["__scopeId","data-v-d1d0c141"]]);export{ue as default};
