import{I as T}from"./InputBase-C5gIDdj6.js";import{B as U}from"./BaseSelect-CC_1HIWH.js";import{B as w}from"./BaseButton-DWDg8t2r.js";import{B as k}from"./BaseAlert-B5bQXRsS.js";import{B as F}from"./BaseModal-BRvmYVR7.js";import{p as B}from"./personasService-2XjK7U9-.js";import{_ as D,b as d,d as r,e,g,x as c,y as x,h as C,z as y,A as b,t as p,F as P,f as O,j as v,n as A,B as S,w as m,k as f,l as j}from"./index-BKYQARX_.js";const G={name:"GestionPersonas",components:{InputBase:T,BaseSelect:U,BaseButton:w,BaseAlert:k,BaseModal:F},data(){return{searchQuery:"",selectedRole:"",selectedRama:"",selectedCourse:"",roleOptions:[{value:"",label:"Todos los roles"},{value:"PARTICIPANTE",label:"Participante"},{value:"DIRIGENTE",label:"Dirigente"},{value:"APOYO",label:"Apoyo"}],ramaOptions:[{value:"",label:"Todas las ramas"},{value:"CASTORES",label:"Castores"},{value:"LOBATOS",label:"Lobatos"},{value:"SCOUTS",label:"Scouts"},{value:"PIONEROS",label:"Pioneros"},{value:"ROVERS",label:"Rovers"}],courseOptions:[{value:"",label:"Todos los cursos"},{value:"PRIMEROS_AUXILIOS",label:"Primeros Auxilios (RCP y Soporte Vital)"},{value:"ORIENTACION_NAV",label:"Orientación y Navegación"},{value:"CAMPAMENTOS",label:"Campamentos y Técnicas de Campo"},{value:"LIDERAZGO_SCOUT",label:"Liderazgo Scout"},{value:"FORMACION_DIRIGENTES",label:"Formación de Dirigentes"}],personaSeleccionada:null,editModalVisible:!1,personaEditada:null,modalTab:"info",modoSoloLectura:!1,confirmModalVisible:!1,mensajeConfirmacion:"",confirmModalAnularVisible:!1,personaAAnular:null,esAdministrador:!0,filtroAplicado:!1,filteredPersonas:[],filtrandoEnProceso:!1,personas:[]}},created(){this.loadPersonas()},computed:{filtrosActivos(){const t=[];if(this.searchQuery&&this.searchQuery.trim()&&t.push(`Búsqueda: "${this.searchQuery.trim()}"`),this.selectedRole){const o=this.roleOptions.find(n=>n.value===this.selectedRole)?.label||this.selectedRole;t.push(`Rol: ${o}`)}if(this.selectedRama){const o=this.ramaOptions.find(n=>n.value===this.selectedRama)?.label||this.selectedRama;t.push(`Rama: ${o}`)}if(this.selectedCourse){const o=this.courseOptions.find(n=>n.value===this.selectedCourse)?.label||this.selectedCourse;t.push(`Curso: ${o}`)}return t},filtroMensaje(){const t=this.filtrosActivos;return t.length===0?"":t.length===1?`Filtro activo: ${t[0]}`:`Filtros activos: ${t.join(" | ")}`},personasFiltradas(){return this.filteredPersonas||[]}},methods:{async loadPersonas(){try{const t=await B.listarBasic();this.personas=(t||[]).map(o=>({nombre:o.nombre||"",rut:o.rut||"",email:o.email||"",rol:o.rol||"",rama:o.rama||"",grupo:o.grupo||"",estado:o.vigente===!1?"No vigente":o.estado||"Vigente",vigente:o.vigente!==!1,telefono:o.telefono||"",fecha_nac:o.fecha_nac||"",direccion:o.direccion||"",profesion:o.profesion||"",cursos:o.cursos||[],historial:o.historial||[],foto:o.foto||null,raw:o.raw||o}))}catch(t){console.error("Error cargando personas",t),this.personas=[]}},seleccionar(t){this.abrirModal(t)},abrirModal(t){this.personaEditada=JSON.parse(JSON.stringify(t||{})),this.personaEditada.historial||(this.personaEditada.historial=[]),this.newHistEntry={fecha:"",descripcion:""},this.modalTab="info",this.editModalVisible=!0,this.personaSeleccionada=t,this.pendingSave=!1},abrirModalVer(t){this.personaEditada=JSON.parse(JSON.stringify(t||{})),this.personaEditada.historial||(this.personaEditada.historial=[]),this.modalTab="info",this.modoSoloLectura=!0,this.editModalVisible=!0,this.personaSeleccionada=t,this.pendingSave=!1},abrirModalEditar(t){this.personaEditada=JSON.parse(JSON.stringify(t||{})),this.personaEditada.historial||(this.personaEditada.historial=[]),this.newHistEntry={fecha:"",descripcion:""},this.modalTab="info",this.modoSoloLectura=!1,this.editModalVisible=!0,this.personaSeleccionada=t,this.pendingSave=!1},cancelarEdicion(){this.editModalVisible=!1,this.personaEditada=null,this.personaSeleccionada=null,this.pendingSave=!1},cerrarDetalle(){this.personaSeleccionada=null},filtrar(){this.filtrandoEnProceso||(this.filtrandoEnProceso=!0,setTimeout(()=>{this.ejecutarFiltrado(),this.filtrandoEnProceso=!1},10))},ejecutarFiltrado(){const t=(this.searchQuery||"").toLowerCase().trim(),o=(this.selectedRole||"").toString().trim().toUpperCase(),n=(this.selectedRama||"").toString().trim().toUpperCase(),E=(this.selectedCourse||"").toString().trim().toUpperCase();if(!(t||o||n||E)){alert("Debe usar un filtro o mas para poder buscar.");return}this.filtroAplicado=!0,this.personaSeleccionada=null,this.filteredPersonas=this.personas.filter(i=>{const h=(i.nombre||"").toLowerCase(),l=(i.rut||"").toLowerCase(),u=(i.email||"").toLowerCase(),R=h.includes(t)||l.includes(t)||u.includes(t),a=(i.rol||"").toString().trim().toUpperCase(),_=(i.rama||"").toString().trim().toUpperCase(),N=(i.cursos||[]).map(L=>(""+L).toString().trim().toUpperCase()),V=o?a===o:!0,I=n?_===n:!0,M=E?N.includes(E):!0;return R&&V&&I&&M}),this.$nextTick(()=>{const i=document.querySelector(".table-wrapper");i&&typeof i.scrollIntoView=="function"&&i.scrollIntoView({behavior:"smooth",block:"start"})})},enrichPersonas(){const t=new Date().toISOString();this.personas=(this.personas||[]).map((o,n)=>{const E=(o.rut||"").toString().trim();let s=null,i="";const h=E.match(/([0-9\.]+)-?([0-9kK])/);h&&(s=Number(h[1].replace(/\./g,""))||null,i=h[2]||"");const l=(o.nombre||"").toString().trim().split(/\s+/);let u="",R="",a=o.nombre||"";return l.length>=2&&(u=l[l.length-2]||"",R=l[l.length-1]||"",a=l.slice(0,l.length-2).join(" ")||a),Object.assign({},o,{PER_ID:n+1,ESC_ID:null,COM_ID:null,USU_ID:null,PER_FECHA_HORA:t,PER_RUN:s,PER_DV:i,PER_APELPAT:u,PER_APELMAT:R,PER_NOMBRES:a||o.nombre,PER_EMAIL:o.email||"",PER_FECHA_NAC:o.fecha_nac||"1990-01-01",PER_DIRECCION:o.direccion||"",PER_TIPO_FONO:"Móvil",PER_FONO:o.telefono||"",PER_ALERGIA_ENFERMEDAD:o.alergias||"",PER_LIMITACION:o.limitacion||"",PER_NOM_EMERGENCIA:o.contacto_emergencia||"",PER_FONO_EMERGENCIA:o.telefono_emergencia||"",PER_OTROS:o.otros||"",PER_NUM_MMAA:o.num_mmaa||0,PER_PROFESION:o.profesion||"",PER_TIEMPO_NNAJ:o.tiempo_nnaj||"",PER_TIEMPO_ADULTO:o.tiempo_adulto||"",PER_RELIGION:o.religion||"",PER_APODO:o.apodo||"",PER_FOTO:o.foto||null,PER_VIGENTE:o.vigente===void 0?!0:!!o.vigente,cursos:o.cursos||[],historial:o.historial||[]})})},exportarExcel(){const t=this.personasFiltradas.map(l=>({Nombre:l.nombre,RUT:l.rut,Email:l.email,Rol:l.rol,Rama:l.rama,Grupo:l.grupo,Estado:l.estado})),o=t.length?Object.keys(t[0]):["Nombre","RUT","Email","Rol","Rama","Grupo","Estado"],n=[];n.push(o.join(","));for(const l of t){const u=o.map(R=>{const a=l[R]??"";return`"${String(a).replace(/"/g,'""')}"`});n.push(u.join(","))}const E=n.join(`\r
`),s=new Blob([E],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(s),h=document.createElement("a");h.href=i,h.setAttribute("download","GestionPersonas.csv"),document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(i)},guardarEdicion(){if(!this.personaEditada||!this.personaEditada.rut||!this.personaEditada.nombre){alert("Nombre y RUT son obligatorios");return}this.mensajeConfirmacion="¿Seguro que quieres guardar estos cambios?",this.confirmModalVisible=!0},confirmarGuardado(){this.confirmModalVisible=!1,this.personaEditada&&(this.personaEditada.PER_FECHA_NAC=this.personaEditada.fecha_nac||this.personaEditada.PER_FECHA_NAC||"",this.personaEditada.PER_DIRECCION=this.personaEditada.direccion||this.personaEditada.PER_DIRECCION||"",this.personaEditada.PER_NOM_EMERGENCIA=this.personaEditada.contacto_emergencia||this.personaEditada.PER_NOM_EMERGENCIA||"",this.personaEditada.PER_FONO_EMERGENCIA=this.personaEditada.telefono_emergencia||this.personaEditada.PER_FONO_EMERGENCIA||"",this.personaEditada.PER_ALERGIA_ENFERMEDAD=this.personaEditada.alergias||this.personaEditada.PER_ALERGIA_ENFERMEDAD||"",this.personaEditada.PER_LIMITACION=this.personaEditada.limitacion||this.personaEditada.PER_LIMITACION||"",this.personaEditada.PER_APODO=this.personaEditada.apodo||this.personaEditada.PER_APODO||"",this.personaEditada.PER_RELIGION=this.personaEditada.religion||this.personaEditada.PER_RELIGION||"",this.personaEditada.PER_TIEMPO_NNAJ=this.personaEditada.tiempo_nnaj||this.personaEditada.PER_TIEMPO_NNAJ||"",this.personaEditada.PER_TIEMPO_ADULTO=this.personaEditada.tiempo_adulto||this.personaEditada.PER_TIEMPO_ADULTO||"",this.personaEditada.PER_VIGENTE=this.personaEditada.vigente===void 0?this.personaEditada.PER_VIGENTE??!0:!!this.personaEditada.vigente);const t=this.personas.findIndex(o=>o.rut===this.personaEditada.rut);if(t!==-1)this.$set?this.$set(this.personas,t,Object.assign({},this.personaEditada)):this.personas.splice(t,1,Object.assign({},this.personaEditada));else{const o=this.personaSeleccionada&&this.personaSeleccionada.rut,n=this.personas.findIndex(E=>E.rut===o);n!==-1&&this.personas.splice(n,1,Object.assign({},this.personaEditada))}if(this.filteredPersonas&&this.filteredPersonas.length){const o=this.filteredPersonas.findIndex(n=>n.rut===this.personaEditada.rut);if(o!==-1)this.filteredPersonas.splice(o,1,Object.assign({},this.personaEditada));else{const n=this.personaSeleccionada&&this.personaSeleccionada.rut,E=this.filteredPersonas.findIndex(s=>s.rut===n);E!==-1&&this.filteredPersonas.splice(E,1,Object.assign({},this.personaEditada))}}this.editModalVisible=!1,this.personaSeleccionada=null,this.personaEditada=null},cancelarConfirmacion(){this.confirmModalVisible=!1},anularPersona(t){this.personaAAnular=t,this.confirmModalAnularVisible=!0},cancelarAnulacion(){this.confirmModalAnularVisible=!1,this.personaAAnular=null},confirmarAnulacion(){if(!this.personaAAnular)return;this.personaAAnular.estado="Anulado",this.personaAAnular.inscripcion="Anulado",this.personaAAnular.vigente=!1;const t=this.personas.findIndex(o=>o.rut===this.personaAAnular.rut);if(t!==-1&&(this.$set?this.$set(this.personas,t,Object.assign({},this.personaAAnular)):this.personas.splice(t,1,Object.assign({},this.personaAAnular))),this.filteredPersonas&&this.filteredPersonas.length){const o=this.filteredPersonas.findIndex(n=>n.rut===this.personaAAnular.rut);o!==-1&&this.filteredPersonas.splice(o,1,Object.assign({},this.personaAAnular))}this.confirmModalAnularVisible=!1,this.personaAAnular=null},addHistEntry(){if(!this.personaEditada)return;const t=(this.newHistEntry.fecha||"").trim(),o=(this.newHistEntry.descripcion||"").trim();if(!t||!o){alert("Fecha y descripción son obligatorias para agregar al historial");return}this.personaEditada.historial=this.personaEditada.historial||[],this.personaEditada.historial.unshift({fecha:t,descripcion:o}),this.newHistEntry={fecha:"",descripcion:""}},getCursoLabel(t){const o=this.courseOptions.find(n=>n.value===t);return o?o.label:t},handleFileUpload(t){const o=t.target.files[0];if(!o)return;if(!o.type.startsWith("image/")){alert("Por favor selecciona un archivo de imagen válido.");return}if(o.size>5*1024*1024){alert("El archivo es demasiado grande. Por favor selecciona una imagen menor a 5MB.");return}const n=new FileReader;n.onload=E=>{this.personaEditada.foto=E.target.result},n.readAsDataURL(o)},removePhoto(){this.personaEditada.foto=null},handleImageError(){this.personaEditada.foto=null}}},H={class:"gestion-personas"},J={class:"filtros"},q={class:"filtros-left"},Q={class:"filtros-right"},z={key:0,class:"filtro-activo",role:"status","aria-live":"polite"},K={class:"main-area"},W={key:0,class:"table-wrapper"},X={"data-label":"Nombre"},Y={"data-label":"RUT"},Z={"data-label":"Email"},$={"data-label":"Rol"},oo={"data-label":"Rama"},eo={"data-label":"Grupo"},so={"data-label":"Estado"},ao={class:"acciones-buttons"},to={key:0,class:"placeholder-row"},io={key:1,class:"no-filtro",style:{padding:"32px","text-align":"center",color:"#666"}},no={class:"modal-edit"},lo={class:"modal-header"},ro={key:0,class:"header-actions"},uo={class:"modal-tabs"},co={class:"foto-perfil-section"},po={class:"foto-container"},mo=["src","alt"],Eo={key:1,class:"foto-placeholder"},fo={key:2,class:"foto-actions"},ho={class:"row"},bo=["readonly"],vo={class:"row"},Ro=["readonly"],Ao={class:"row"},go=["readonly"],_o={class:"row"},yo=["readonly"],Co={class:"row"},Po=["readonly"],Oo={class:"row"},So=["readonly"],No={class:"row"},Vo=["readonly"],Io={class:"row"},Mo=["readonly"],Lo={class:"row"},To=["readonly"],Uo={class:"row"},wo=["readonly"],ko={class:"row"},Fo=["readonly"],Bo={class:"row"},Do=["readonly"],xo={class:"row"},jo=["readonly"],Go={class:"row"},Ho=["readonly"],Jo={class:"row"},qo=["readonly"],Qo={class:"row"},zo=["disabled"],Ko={class:"row"},Wo={class:"row"},Xo={class:"hist-list"},Yo={key:0},Zo={key:0,class:"historial-curso"},$o={class:"confirm-content"},oe={class:"confirm-actions"},ee={class:"confirm-content"},se={class:"confirm-actions"};function ae(t,o,n,E,s,i){const h=y("InputBase"),l=y("BaseSelect"),u=y("BaseButton"),R=y("BaseModal");return r(),d("div",H,[e("div",J,[e("div",q,[c(h,{modelValue:s.searchQuery,"onUpdate:modelValue":o[0]||(o[0]=a=>s.searchQuery=a),placeholder:"Buscar por nombre, RUT, email...",onKeydown:x(C(i.filtrar,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),c(l,{modelValue:s.selectedRole,"onUpdate:modelValue":o[1]||(o[1]=a=>s.selectedRole=a),options:s.roleOptions,placeholder:"Todos los roles"},null,8,["modelValue","options"]),c(l,{modelValue:s.selectedCourse,"onUpdate:modelValue":o[2]||(o[2]=a=>s.selectedCourse=a),options:s.courseOptions,placeholder:"Todos los cursos"},null,8,["modelValue","options"]),c(l,{modelValue:s.selectedRama,"onUpdate:modelValue":o[3]||(o[3]=a=>s.selectedRama=a),options:s.ramaOptions,placeholder:"Todas las ramas"},null,8,["modelValue","options"])]),e("div",Q,[c(u,{class:"btn-search",variant:"primary",onClick:i.filtrar},{default:b(()=>[...o[32]||(o[32]=[v("🔎 Buscar",-1)])]),_:1},8,["onClick"]),c(u,{class:"btn-export",variant:"secondary",onClick:i.exportarExcel},{default:b(()=>[...o[33]||(o[33]=[v("📊 Exportar",-1)])]),_:1},8,["onClick"])])]),s.filtroAplicado&&i.filtrosActivos.length>0?(r(),d("div",z,p(i.filtroMensaje),1)):g("",!0),e("div",K,[s.filtroAplicado?(r(),d("div",W,[e("table",null,[o[38]||(o[38]=e("thead",null,[e("tr",null,[e("th",null,"Nombre"),e("th",null,"RUT"),e("th",null,"Email"),e("th",null,"Rol"),e("th",null,"Rama"),e("th",null,"Grupo"),e("th",null,"Estado"),e("th",null,"Acciones")])],-1)),e("tbody",null,[(r(!0),d(P,null,O(i.personasFiltradas,a=>(r(),d("tr",{key:a.rut,class:A({"persona-anulada":a.estado==="Anulado"})},[e("td",X,p(a.nombre),1),e("td",Y,p(a.rut),1),e("td",Z,p(a.email),1),e("td",$,p(a.rol),1),e("td",oo,p(a.rama),1),e("td",eo,p(a.grupo),1),e("td",so,[e("span",{class:A(["estado",a.estado.toLowerCase().replace(/\s+/g,"-")])},p(a.estado),3)]),e("td",null,[e("div",ao,[c(u,{class:"btn-ver btn-view",variant:"info",onClick:_=>i.abrirModalVer(a)},{default:b(()=>[...o[34]||(o[34]=[v("Ver",-1)])]),_:1},8,["onClick"]),s.esAdministrador?(r(),S(u,{key:0,class:"btn-editar btn-edit",variant:"secondary",onClick:_=>i.abrirModalEditar(a)},{default:b(()=>[...o[35]||(o[35]=[v(" Editar ",-1)])]),_:1},8,["onClick"])):g("",!0),s.esAdministrador?(r(),S(u,{key:1,class:"btn-anular btn-cancel",variant:"warning",onClick:_=>i.anularPersona(a)},{default:b(()=>[...o[36]||(o[36]=[v(" Anular ",-1)])]),_:1},8,["onClick"])):g("",!0)])])],2))),128)),i.personasFiltradas.length===0?(r(),d("tr",to,[...o[37]||(o[37]=[e("td",{"data-label":"Nombre",colspan:"8"},"No hay participantes para mostrar",-1)])])):g("",!0)])])])):(r(),d("div",io,' Aplica filtros y presiona "Buscar" para ver la lista de personas. ')),c(R,{modelValue:s.editModalVisible,"onUpdate:modelValue":o[29]||(o[29]=a=>s.editModalVisible=a),onClose:i.cancelarEdicion},{default:b(()=>[e("div",no,[e("header",lo,[e("h3",null,p(s.modoSoloLectura?"Ver":"Editar")+" - "+p(s.personaEditada?.nombre||""),1),s.modoSoloLectura?g("",!0):(r(),d("div",ro,[c(u,{class:"btn-save",type:"button",variant:"primary",onClick:i.guardarEdicion},{default:b(()=>[...o[39]||(o[39]=[v("💾 Guardar",-1)])]),_:1},8,["onClick"])]))]),e("div",uo,[e("button",{class:A({active:s.modalTab==="info"}),onClick:o[4]||(o[4]=a=>s.modalTab="info")},"Info",2),e("button",{class:A({active:s.modalTab==="hist"}),onClick:o[5]||(o[5]=a=>s.modalTab="hist")},"Historial",2)]),s.modalTab==="info"?(r(),d("form",{key:0,onSubmit:o[28]||(o[28]=C((...a)=>i.guardarEdicion&&i.guardarEdicion(...a),["prevent"])),class:"modal-form"},[e("div",co,[e("div",po,[s.personaEditada.foto?(r(),d("img",{key:0,src:s.personaEditada.foto,alt:`Foto de ${s.personaEditada.nombre}`,class:"foto-perfil",onError:o[6]||(o[6]=(...a)=>i.handleImageError&&i.handleImageError(...a))},null,40,mo)):(r(),d("div",Eo,[...o[40]||(o[40]=[e("span",{class:"foto-icon"},"👤",-1),e("span",{class:"foto-text"},"Sin foto",-1)])])),s.modoSoloLectura?g("",!0):(r(),d("div",fo,[e("input",{ref:"fotoInput",type:"file",accept:"image/*",onChange:o[7]||(o[7]=(...a)=>i.handleFileUpload&&i.handleFileUpload(...a)),style:{display:"none"}},null,544),e("button",{type:"button",onClick:o[8]||(o[8]=a=>t.$refs.fotoInput?.click()),class:"btn-foto-upload"}," 📷 "+p(s.personaEditada.foto?"Cambiar":"Subir")+" Foto ",1),s.personaEditada.foto?(r(),d("button",{key:0,type:"button",onClick:o[9]||(o[9]=(...a)=>i.removePhoto&&i.removePhoto(...a)),class:"btn-foto-remove"}," 🗑️ Eliminar ")):g("",!0)]))])]),e("div",ho,[o[41]||(o[41]=e("label",null,"Nombre",-1)),m(e("input",{"onUpdate:modelValue":o[10]||(o[10]=a=>s.personaEditada.nombre=a),readonly:s.modoSoloLectura,required:""},null,8,bo),[[f,s.personaEditada.nombre]])]),e("div",vo,[o[42]||(o[42]=e("label",null,"RUT",-1)),m(e("input",{"onUpdate:modelValue":o[11]||(o[11]=a=>s.personaEditada.rut=a),readonly:s.modoSoloLectura,required:""},null,8,Ro),[[f,s.personaEditada.rut]])]),e("div",Ao,[o[43]||(o[43]=e("label",null,"Email",-1)),m(e("input",{"onUpdate:modelValue":o[12]||(o[12]=a=>s.personaEditada.email=a),readonly:s.modoSoloLectura,type:"email"},null,8,go),[[f,s.personaEditada.email]])]),e("div",_o,[o[44]||(o[44]=e("label",null,"Teléfono",-1)),m(e("input",{"onUpdate:modelValue":o[13]||(o[13]=a=>s.personaEditada.telefono=a),readonly:s.modoSoloLectura},null,8,yo),[[f,s.personaEditada.telefono]])]),e("div",Co,[o[45]||(o[45]=e("label",null,"Profesión",-1)),m(e("input",{"onUpdate:modelValue":o[14]||(o[14]=a=>s.personaEditada.profesion=a),readonly:s.modoSoloLectura},null,8,Po),[[f,s.personaEditada.profesion]])]),e("div",Oo,[o[46]||(o[46]=e("label",null,"Fecha Nac.",-1)),m(e("input",{"onUpdate:modelValue":o[15]||(o[15]=a=>s.personaEditada.fecha_nac=a),readonly:s.modoSoloLectura,type:"date"},null,8,So),[[f,s.personaEditada.fecha_nac]])]),e("div",No,[o[47]||(o[47]=e("label",null,"Dirección",-1)),m(e("input",{"onUpdate:modelValue":o[16]||(o[16]=a=>s.personaEditada.direccion=a),readonly:s.modoSoloLectura},null,8,Vo),[[f,s.personaEditada.direccion]])]),e("div",Io,[o[48]||(o[48]=e("label",null,"Contacto Emerg.",-1)),m(e("input",{"onUpdate:modelValue":o[17]||(o[17]=a=>s.personaEditada.contacto_emergencia=a),readonly:s.modoSoloLectura},null,8,Mo),[[f,s.personaEditada.contacto_emergencia]])]),e("div",Lo,[o[49]||(o[49]=e("label",null,"Tel. Emerg.",-1)),m(e("input",{"onUpdate:modelValue":o[18]||(o[18]=a=>s.personaEditada.telefono_emergencia=a),readonly:s.modoSoloLectura},null,8,To),[[f,s.personaEditada.telefono_emergencia]])]),e("div",Uo,[o[50]||(o[50]=e("label",null,"Alergias",-1)),m(e("input",{"onUpdate:modelValue":o[19]||(o[19]=a=>s.personaEditada.alergias=a),readonly:s.modoSoloLectura},null,8,wo),[[f,s.personaEditada.alergias]])]),e("div",ko,[o[51]||(o[51]=e("label",null,"Limitación",-1)),m(e("input",{"onUpdate:modelValue":o[20]||(o[20]=a=>s.personaEditada.limitacion=a),readonly:s.modoSoloLectura},null,8,Fo),[[f,s.personaEditada.limitacion]])]),e("div",Bo,[o[52]||(o[52]=e("label",null,"Apodo",-1)),m(e("input",{"onUpdate:modelValue":o[21]||(o[21]=a=>s.personaEditada.apodo=a),readonly:s.modoSoloLectura},null,8,Do),[[f,s.personaEditada.apodo]])]),e("div",xo,[o[53]||(o[53]=e("label",null,"Religión",-1)),m(e("input",{"onUpdate:modelValue":o[22]||(o[22]=a=>s.personaEditada.religion=a),readonly:s.modoSoloLectura},null,8,jo),[[f,s.personaEditada.religion]])]),e("div",Go,[o[54]||(o[54]=e("label",null,"Tiempo NNAJ",-1)),m(e("input",{"onUpdate:modelValue":o[23]||(o[23]=a=>s.personaEditada.tiempo_nnaj=a),readonly:s.modoSoloLectura},null,8,Ho),[[f,s.personaEditada.tiempo_nnaj]])]),e("div",Jo,[o[55]||(o[55]=e("label",null,"Tiempo Adulto",-1)),m(e("input",{"onUpdate:modelValue":o[24]||(o[24]=a=>s.personaEditada.tiempo_adulto=a),readonly:s.modoSoloLectura},null,8,qo),[[f,s.personaEditada.tiempo_adulto]])]),e("div",Qo,[o[57]||(o[57]=e("label",null,"Vigente",-1)),m(e("select",{"onUpdate:modelValue":o[25]||(o[25]=a=>s.personaEditada.vigente=a),disabled:s.modoSoloLectura},[...o[56]||(o[56]=[e("option",{value:!0},"Si",-1),e("option",{value:!1},"No",-1)])],8,zo),[[j,s.personaEditada.vigente]])]),e("div",Ko,[o[58]||(o[58]=e("label",null,"Rol",-1)),c(l,{modelValue:s.personaEditada.rol,"onUpdate:modelValue":o[26]||(o[26]=a=>s.personaEditada.rol=a),options:s.roleOptions,disabled:s.modoSoloLectura},null,8,["modelValue","options","disabled"])]),e("div",Wo,[o[59]||(o[59]=e("label",null,"Rama",-1)),c(l,{modelValue:s.personaEditada.rama,"onUpdate:modelValue":o[27]||(o[27]=a=>s.personaEditada.rama=a),options:s.ramaOptions,disabled:s.modoSoloLectura},null,8,["modelValue","options","disabled"])])],32)):(r(),d("div",{key:1,class:A(["historial-panel",{"historial-anulado":s.personaEditada.estado==="Anulado"}])},[e("div",Xo,[(s.personaEditada.historial||[]).length===0?(r(),d("div",Yo,"No hay participaciones previas.")):g("",!0),e("ul",null,[(r(!0),d(P,null,O(s.personaEditada.historial||[],(a,_)=>(r(),d("li",{key:_,class:A(["historial-item",{"historial-item-anulado":s.personaEditada.estado==="Anulado"}])},[e("div",{class:A(["historial-content",{"historial-content-anulado":s.personaEditada.estado==="Anulado"}])},[e("div",{class:A(["historial-main",{"historial-main-anulado":s.personaEditada.estado==="Anulado"}])},[e("strong",null,p(a.fecha),1),v(": "+p(a.descripcion),1)],2),a.curso?(r(),d("div",Zo,[e("span",{class:A(["curso-badge",{"curso-badge-anulado":s.personaEditada.estado==="Anulado"}])},p(i.getCursoLabel(a.curso)),3),e("span",{class:A(["aprobacion-badge",a.aprobado?"aprobado":"no-aprobado",{"aprobacion-badge-anulado":s.personaEditada.estado==="Anulado"}])},p(a.aprobado?"✅ Aprobado":"❌ No Aprobado"),3)])):g("",!0)],2)],2))),128))])])],2))])]),_:1},8,["modelValue","onClose"]),c(R,{modelValue:s.confirmModalVisible,"onUpdate:modelValue":o[30]||(o[30]=a=>s.confirmModalVisible=a),title:"Confirmar Cambios"},{default:b(()=>[e("div",$o,[o[62]||(o[62]=e("div",{class:"confirm-icon"},"⚠️",-1)),e("p",null,p(s.mensajeConfirmacion),1),e("div",oe,[c(u,{onClick:i.cancelarConfirmacion,variant:"secondary",class:"btn-modal-cancel"},{default:b(()=>[...o[60]||(o[60]=[v(" ❌ Cancelar ",-1)])]),_:1},8,["onClick"]),c(u,{onClick:i.confirmarGuardado,variant:"primary",class:"btn-modal-confirm"},{default:b(()=>[...o[61]||(o[61]=[v(" ✅ Confirmar ",-1)])]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"]),c(R,{modelValue:s.confirmModalAnularVisible,"onUpdate:modelValue":o[31]||(o[31]=a=>s.confirmModalAnularVisible=a),title:"Confirmar Anulación"},{default:b(()=>[e("div",ee,[o[67]||(o[67]=e("div",{class:"confirm-icon"},"⚠️",-1)),e("p",null,[o[63]||(o[63]=v("¿Estás seguro de que deseas anular a ",-1)),e("strong",null,p(s.personaAAnular?.nombre),1),o[64]||(o[64]=v("?",-1))]),o[68]||(o[68]=e("p",{class:"confirm-warning"},"Esta acción marcará a la persona en gris y cambiará su estado.",-1)),e("div",se,[c(u,{onClick:i.cancelarAnulacion,variant:"secondary",class:"btn-modal-cancel"},{default:b(()=>[...o[65]||(o[65]=[v(" ❌ Cancelar ",-1)])]),_:1},8,["onClick"]),c(u,{onClick:i.confirmarAnulacion,variant:"warning",class:"btn-modal-anular"},{default:b(()=>[...o[66]||(o[66]=[v(" ⚠️ Anular ",-1)])]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"])])])}const ce=D(G,[["render",ae],["__scopeId","data-v-8458449f"]]);export{ce as default};
