import{I as M}from"./InputBase-BUQgxqIb.js";import{_ as C,a as c,b as l,f,d as o,i as I,t as p,F as _,e as b,n as g,s as R,x as L,y as P,z as N,A as S,g as G,w as u,j as m,k as y}from"./index-AxCKe8US.js";import{B as D}from"./BaseButton-Bqv1-etg.js";import{B}from"./BaseAlert-VEY4pNt7.js";import{B as w}from"./BaseModal-Cmh2x84d.js";const k={name:"BaseSelect",props:{modelValue:{type:[String,Number,Boolean,Object],default:""},options:{type:Array,required:!0,default:()=>[]},label:{type:String,default:""},placeholder:{type:String,default:"Seleccione una opciÃ³n"},id:{type:String,default:()=>`select-${Math.random().toString(36).substr(2,9)}`},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{type:String,default:""},helpText:{type:String,default:""},optionValue:{type:String,default:"value"},optionLabel:{type:String,default:"label"},optionDisabled:{type:String,default:"disabled"}},emits:["update:modelValue","change"],methods:{handleChange(t){const e=t.target.value;this.$emit("update:modelValue",e),this.$emit("change",e)},getOptionValue(t){return typeof t=="object"?t[this.optionValue]:t},getOptionLabel(t){return typeof t=="object"?t[this.optionLabel]:t},getOptionDisabled(t){return typeof t=="object"&&t[this.optionDisabled]||!1}}},Z={class:"base-select"},F=["for"],z={key:0,class:"base-select__required"},j=["id","value","disabled"],x={key:0,value:"",disabled:""},H=["value","disabled"],q={key:1,class:"base-select__error"},J={key:2,class:"base-select__help"};function Q(t,e,n,E,a,s){return l(),c("div",Z,[n.label?(l(),c("label",{key:0,for:n.id,class:"base-select__label"},[I(p(n.label)+" ",1),n.required?(l(),c("span",z,"*")):f("",!0)],8,F)):f("",!0),o("select",{id:n.id,value:n.modelValue,onChange:e[0]||(e[0]=(...d)=>s.handleChange&&s.handleChange(...d)),disabled:n.disabled,class:g(["base-select__element",{"base-select__element--error":n.error,"base-select__element--disabled":n.disabled}])},[n.placeholder?(l(),c("option",x,p(n.placeholder),1)):f("",!0),(l(!0),c(_,null,b(n.options,d=>(l(),c("option",{key:s.getOptionValue(d),value:s.getOptionValue(d),disabled:s.getOptionDisabled(d)},p(s.getOptionLabel(d)),9,H))),128))],42,j),n.error?(l(),c("div",q,p(n.error),1)):f("",!0),n.helpText?(l(),c("div",J,p(n.helpText),1)):f("",!0)])}const X=C(k,[["render",Q],["__scopeId","data-v-e1442cd4"]]),Y={name:"GestionPersonas",components:{InputBase:M,BaseSelect:X,BaseButton:D,BaseAlert:B,BaseModal:w},data(){return{searchQuery:"",selectedRole:"",selectedRama:"",selectedCourse:"",roleOptions:[{value:"",label:"Todos los roles"},{value:"PARTICIPANTE",label:"Participante"},{value:"DIRIGENTE",label:"Dirigente"},{value:"APOYO",label:"Apoyo"}],ramaOptions:[{value:"",label:"Todas las ramas"},{value:"CASTORES",label:"Castores"},{value:"LOBATOS",label:"Lobatos"},{value:"SCOUTS",label:"Scouts"},{value:"PIONEROS",label:"Pioneros"},{value:"ROVERS",label:"Rovers"}],courseOptions:[{value:"",label:"Todos los cursos"},{value:"PRIMEROS_AUXILIOS",label:"Primeros Auxilios (RCP y Soporte Vital)"},{value:"ORIENTACION_NAV",label:"OrientaciÃ³n y NavegaciÃ³n"},{value:"CAMPAMENTOS",label:"Campamentos y TÃ©cnicas de Campo"},{value:"LIDERAZGO_SCOUT",label:"Liderazgo Scout"},{value:"FORMACION_DIRIGENTES",label:"FormaciÃ³n de Dirigentes"}],personaSeleccionada:null,editModalVisible:!1,personaEditada:null,modalTab:"info",pendingSave:!1,filtroAplicado:!1,filteredPersonas:[],personas:[{nombre:"JUAN PÃ‰REZ GONZÃLEZ",rut:"12.345.678-9",email:"juan.perez@email.com",telefono:"+56 9 1234 5678",profesion:"INGENIERO",rol:"PARTICIPANTE",rama:"SCOUTS",grupo:"GRUPO ARAUCO",zona:"ZONA SUR",distrito:"BIOBÃO",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Pendiente",cursos:["PRIMEROS_AUXILIOS","CAMPAMENTOS"],historial:[{fecha:"2024-01-10",descripcion:"Campamento regional"},{fecha:"2023-11-05",descripcion:"Taller de primeros auxilios"}],fecha_nac:"1990-05-10",direccion:"Av. Libertad 123, ConcepciÃ³n",contacto_emergencia:"MARIA GONZÃLEZ",telefono_emergencia:"+56 9 4444 5555",alergias:"",limitacion:"",num_mmaa:0,tiempo_nnaj:"3 aÃ±os",tiempo_adulto:"2 aÃ±os",religion:"CatÃ³lica",apodo:"Juanca",foto:null,vigente:!0,otros:""},{nombre:"MARÃA GONZÃLEZ LÃ“PEZ",rut:"98.765.432-1",email:"maria.gonzalez@email.com",telefono:"+56 9 2222 3333",profesion:"DOCENTE",rol:"PARTICIPANTE",rama:"ROVERS",grupo:"GRUPO LAUTARO",zona:"ZONA SUR",distrito:"BIOBÃO",estado:"Preinscrito",inscripcion:"Preinscrito",pago:"Pendiente",acreditacion:"Pendiente",cursos:["ORIENTACION_NAV"],historial:[{fecha:"2023-08-20",descripcion:"Actividad de voluntariado"}],fecha_nac:"1992-03-22",direccion:"Calle Los Pinos 45, Talcahuano",contacto_emergencia:"JOSÃ‰ LÃ“PEZ",telefono_emergencia:"+56 9 1010 2020",alergias:"Penicilina",limitacion:"",num_mmaa:0,tiempo_nnaj:"1 aÃ±o",tiempo_adulto:"4 aÃ±os",religion:"Evangelica",apodo:"Maru",foto:null,vigente:!0,otros:""},{nombre:"CARLOS RAMÃREZ SOTO",rut:"11.222.333-4",email:"carlos.ramirez@email.com",telefono:"+56 9 5555 6666",profesion:"ESTUDIANTE",rol:"PARTICIPANTE",rama:"PIONEROS",grupo:"GRUPO CAUPOLICÃN",zona:"ZONA SUR",distrito:"BIOBÃO",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Pendiente",cursos:["CAMPAMENTOS"],historial:[],fecha_nac:"2004-09-10",direccion:"Pasaje Los Aromos 7, ConcepciÃ³n",contacto_emergencia:"LAURA SOTO",telefono_emergencia:"+56 9 5555 0000",alergias:"Ninguna",limitacion:"",num_mmaa:0,tiempo_nnaj:"2 aÃ±os",tiempo_adulto:"0 aÃ±os",religion:"Sin religiÃ³n",apodo:"Carlitos",foto:null,vigente:!0,otros:""},{nombre:"ANA TORRES RIVERA",rut:"15.987.654-2",email:"ana.torres@email.com",telefono:"+56 9 7777 8888",profesion:"MÃ‰DICO",rol:"DIRIGENTE",rama:"SCOUTS",grupo:"GRUPO LEBU",zona:"ZONA SUR",distrito:"BIOBÃO",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Aprobada",cursos:["FORMACION_DIRIGENTES"],historial:[{fecha:"2022-10-12",descripcion:"LÃ­der regional"}],fecha_nac:"1981-12-02",direccion:"Av. Argentina 200, ConcepciÃ³n",contacto_emergencia:"CARLOS TORRES",telefono_emergencia:"+56 9 7777 1111",alergias:"",limitacion:"",num_mmaa:0,tiempo_nnaj:"0 aÃ±os",tiempo_adulto:"10 aÃ±os",religion:"CatÃ³lica",apodo:"Ana",foto:null,vigente:!0,otros:""},{nombre:"PABLO MENDEZ",rut:"20.111.222-3",email:"pablo.mendez@email.com",telefono:"+56 9 3333 4444",profesion:"ARQUITECTO",rol:"APOYO",rama:"CASTORES",grupo:"GRUPO CASTOR",zona:"ZONA NORTE",distrito:"SANTIAGO",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Aprobada",cursos:["PRIMEROS_AUXILIOS"],historial:[{fecha:"2021-03-05",descripcion:"Voluntariado en campo"}],fecha_nac:"1979-04-14",direccion:"Calle Larga 555, Santiago",contacto_emergencia:"SOFIA MENDEZ",telefono_emergencia:"+56 9 6666 7777",alergias:"Polen",limitacion:"",num_mmaa:0,tiempo_nnaj:"0 aÃ±os",tiempo_adulto:"6 aÃ±os",religion:"CatÃ³lica",apodo:"",foto:null,vigente:!0,otros:""},{nombre:"LAURA VEGA",rut:"21.222.333-4",email:"laura.vega@email.com",telefono:"+56 9 4444 5555",profesion:"ENFERMERA",rol:"DIRIGENTE",rama:"LOBATOS",grupo:"GRUPO LOBITOS",zona:"ZONA CENTRO",distrito:"SANTIAGO",estado:"Preinscrito",inscripcion:"Preinscrito",pago:"Pendiente",acreditacion:"Pendiente",cursos:["PRIMEROS_AUXILIOS"],historial:[{fecha:"2020-07-18",descripcion:"AtenciÃ³n sanitaria en campamento"}],fecha_nac:"1987-11-30",direccion:"Av. Providencia 321, Santiago",contacto_emergencia:"MARTA VEGA",telefono_emergencia:"+56 9 8888 0000",alergias:"",limitacion:"",num_mmaa:0,tiempo_nnaj:"0 aÃ±os",tiempo_adulto:"8 aÃ±os",religion:"CatÃ³lica",apodo:"Lau",foto:null,vigente:!0,otros:""},{nombre:"MARIO LOPEZ",rut:"22.333.444-5",email:"mario.lopez@email.com",telefono:"+56 9 6666 7777",profesion:"ESTUDIANTE",rol:"PARTICIPANTE",rama:"SCOUTS",grupo:"GRUPO SUR",zona:"ZONA SUR",distrito:"SANTIAGO",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Aprobada",cursos:["CAMPAMENTOS"],historial:[{fecha:"2024-02-01",descripcion:"Competencia regional"}]},{nombre:"SUSANA RIVERA",rut:"23.444.555-6",email:"susana.rivera@email.com",telefono:"+56 9 8888 9999",profesion:"DOCENTE",rol:"APOYO",rama:"PIONEROS",grupo:"GRUPO PION",zona:"ZONA NORTE",distrito:"VALPARAÃSO",estado:"Pendiente",inscripcion:"Pendiente",pago:"Pendiente",acreditacion:"Pendiente",cursos:["FORMACION_DIRIGENTES"],historial:[{fecha:"2019-06-12",descripcion:"CapacitaciÃ³n docente"}]},{nombre:"RODRIGO CAMPOS",rut:"24.555.666-7",email:"rodrigo.campos@email.com",telefono:"+56 9 1010 1111",profesion:"INGENIERO",rol:"DIRIGENTE",rama:"ROVERS",grupo:"GRUPO ROVER",zona:"ZONA CENTRO",distrito:"VALPARAÃSO",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Aprobada",cursos:["LIDERAZGO_SCOUT"],historial:[{fecha:"2022-12-01",descripcion:"Organizador de actividad"}]},{nombre:"ELENA FERNANDEZ",rut:"25.666.777-8",email:"elena.fernandez@email.com",telefono:"+56 9 1212 1313",profesion:"ABOGADA",rol:"PARTICIPANTE",rama:"CASTORES",grupo:"GRUPO CASTOR 2",zona:"ZONA NORTE",distrito:"ANTOFAGASTA",estado:"Preinscrito",inscripcion:"Preinscrito",pago:"Pendiente",acreditacion:"Pendiente",cursos:["ORIENTACION_NAV"],historial:[{fecha:"2021-09-09",descripcion:"ParticipaciÃ³n en taller legal"}]},{nombre:"ANDRES GOMEZ",rut:"26.777.888-9",email:"andres.gomez@email.com",telefono:"+56 9 1414 1515",profesion:"PROFESOR",rol:"PARTICIPANTE",rama:"LOBATOS",grupo:"GRUPO LOBOS",zona:"ZONA CENTRO",distrito:"CONCEPCIÃ“N",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Pendiente",cursos:["CAMPAMENTOS"],historial:[{fecha:"2023-04-11",descripcion:"Taller educativo"}]},{nombre:"VERONICA SALAS",rut:"27.888.999-0",email:"veronica.salas@email.com",telefono:"+56 9 1616 1717",profesion:"ENFERMERA",rol:"APOYO",rama:"SCOUTS",grupo:"GRUPO SUR 2",zona:"ZONA SUR",distrito:"CONCEPCIÃ“N",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Aprobada",cursos:["PRIMEROS_AUXILIOS"],historial:[{fecha:"2020-02-14",descripcion:"CampaÃ±a de salud"}]},{nombre:"RICARDO PENA",rut:"28.999.000-1",email:"ricardo.pena@email.com",telefono:"+56 9 1818 1919",profesion:"TÃ‰CNICO",rol:"DIRIGENTE",rama:"PIONEROS",grupo:"GRUPO PION 2",zona:"ZONA NORTE",distrito:"IQUIQUE",estado:"Pendiente",inscripcion:"Pendiente",pago:"Pendiente",acreditacion:"Pendiente",cursos:["FORMACION_DIRIGENTES"],historial:[{fecha:"2018-05-30",descripcion:"FormaciÃ³n tÃ©cnica"}]},{nombre:"MARTA LOZANO",rut:"29.000.111-2",email:"marta.lozano@email.com",telefono:"+56 9 2020 2121",profesion:"ESTILISTA",rol:"PARTICIPANTE",rama:"ROVERS",grupo:"GRUPO ROVER 2",zona:"ZONA SUR",distrito:"VALPARAÃSO",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Aprobada",cursos:["LIDERAZGO_SCOUT"],historial:[{fecha:"2022-01-20",descripcion:"OrganizaciÃ³n de evento"}]},{nombre:"HUGO SANCHEZ",rut:"30.111.222-3",email:"hugo.sanchez@email.com",telefono:"+56 9 2223 2324",profesion:"MUSICO",rol:"APOYO",rama:"CASTORES",grupo:"GRUPO CASTOR 3",zona:"ZONA CENTRO",distrito:"SANTIAGO",estado:"Preinscrito",inscripcion:"Preinscrito",pago:"Pendiente",acreditacion:"Pendiente",cursos:["ORIENTACION_NAV"],historial:[{fecha:"2019-11-02",descripcion:"Actividad cultural"}]},{nombre:"CAMILA RIOS",rut:"31.222.333-4",email:"camila.rios@email.com",telefono:"+56 9 2425 2627",profesion:"INGENIERA",rol:"DIRIGENTE",rama:"LOBATOS",grupo:"GRUPO LOBOS 2",zona:"ZONA SUR",distrito:"CONCEPCIÃ“N",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Aprobada",cursos:["FORMACION_DIRIGENTES"],historial:[{fecha:"2021-06-15",descripcion:"CoordinaciÃ³n de campamento"}]},{nombre:"OSCAR NAVARRO",rut:"32.333.444-5",email:"oscar.navarro@email.com",telefono:"+56 9 2728 2929",profesion:"ESTUDIANTE",rol:"PARTICIPANTE",rama:"SCOUTS",grupo:"GRUPO SUR 3",zona:"ZONA SUR",distrito:"TALCA",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Pendiente",cursos:["CAMPAMENTOS"],historial:[{fecha:"2023-09-05",descripcion:"Competencia local"}]},{nombre:"LUIS FARIAS",rut:"33.444.555-6",email:"luis.farias@email.com",telefono:"+56 9 3031 3233",profesion:"AGRICULTOR",rol:"APOYO",rama:"PIONEROS",grupo:"GRUPO PION 3",zona:"ZONA NORTE",distrito:"IQUIQUE",estado:"Inscrito",inscripcion:"Inscrito",pago:"Confirmado",acreditacion:"Aprobada",cursos:["PRIMEROS_AUXILIOS"],historial:[{fecha:"2022-08-10",descripcion:"Apoyo logÃ­stico"}]},{nombre:"NICOLE MORA",rut:"34.555.666-7",email:"nicole.mora@email.com",telefono:"+56 9 3334 3536",profesion:"DOCTORA",rol:"DIRIGENTE",rama:"ROVERS",grupo:"GRUPO ROVER 3",zona:"ZONA CENTRO",distrito:"SANTIAGO",estado:"Preinscrito",inscripcion:"Preinscrito",pago:"Pendiente",acreditacion:"Pendiente",cursos:["FORMACION_DIRIGENTES","PRIMEROS_AUXILIOS"],historial:[{fecha:"2017-04-22",descripcion:"AtenciÃ³n mÃ©dica en evento"}]}]}},created(){this.enrichPersonas()},computed:{filtroMensaje(){return`Filtro activo: Solo se muestran personas con rol "${this.selectedRole}"`},personasFiltradas(){return this.filteredPersonas||[]}},methods:{seleccionar(t){this.abrirModal(t)},abrirModal(t){this.personaEditada=JSON.parse(JSON.stringify(t||{})),this.personaEditada.historial||(this.personaEditada.historial=[]),this.newHistEntry={fecha:"",descripcion:""},this.modalTab="info",this.editModalVisible=!0,this.personaSeleccionada=t,this.pendingSave=!1},cancelarEdicion(){this.editModalVisible=!1,this.personaEditada=null,this.personaSeleccionada=null,this.pendingSave=!1},cerrarDetalle(){this.personaSeleccionada=null},filtrar(){this.filtroAplicado=!0,this.personaSeleccionada=null;const t=(this.searchQuery||"").toLowerCase().trim(),e=(this.selectedRole||"").toString().trim().toUpperCase(),n=(this.selectedRama||"").toString().trim().toUpperCase(),E=(this.selectedCourse||"").toString().trim().toUpperCase();this.filteredPersonas=this.personas.filter(a=>{const s=(a.nombre||"").toLowerCase(),d=(a.rut||"").toLowerCase(),r=(a.email||"").toLowerCase(),O=s.includes(t)||d.includes(t)||r.includes(t),A=(a.rol||"").toString().trim().toUpperCase(),i=(a.rama||"").toString().trim().toUpperCase(),h=(a.cursos||[]).map(V=>(""+V).toString().trim().toUpperCase()),T=e?A===e:!0,v=n?i===n:!0,U=E?h.includes(E):!0;return O&&T&&v&&U}),this.$nextTick(()=>{const a=document.querySelector(".table-wrapper");a&&typeof a.scrollIntoView=="function"&&a.scrollIntoView({behavior:"smooth",block:"start"})})},enrichPersonas(){const t=new Date().toISOString();this.personas=(this.personas||[]).map((e,n)=>{const E=(e.rut||"").toString().trim();let a=null,s="";const d=E.match(/([0-9\.]+)-?([0-9kK])/);d&&(a=Number(d[1].replace(/\./g,""))||null,s=d[2]||"");const r=(e.nombre||"").toString().trim().split(/\s+/);let O="",A="",i=e.nombre||"";return r.length>=2&&(O=r[r.length-2]||"",A=r[r.length-1]||"",i=r.slice(0,r.length-2).join(" ")||i),Object.assign({},e,{PER_ID:n+1,ESC_ID:null,COM_ID:null,USU_ID:null,PER_FECHA_HORA:t,PER_RUN:a,PER_DV:s,PER_APELPAT:O,PER_APELMAT:A,PER_NOMBRES:i||e.nombre,PER_EMAIL:e.email||"",PER_FECHA_NAC:e.fecha_nac||"1990-01-01",PER_DIRECCION:e.direccion||"",PER_TIPO_FONO:"MÃ³vil",PER_FONO:e.telefono||"",PER_ALERGIA_ENFERMEDAD:e.alergias||"",PER_LIMITACION:e.limitacion||"",PER_NOM_EMERGENCIA:e.contacto_emergencia||"",PER_FONO_EMERGENCIA:e.telefono_emergencia||"",PER_OTROS:e.otros||"",PER_NUM_MMAA:e.num_mmaa||0,PER_PROFESION:e.profesion||"",PER_TIEMPO_NNAJ:e.tiempo_nnaj||"",PER_TIEMPO_ADULTO:e.tiempo_adulto||"",PER_RELIGION:e.religion||"",PER_APODO:e.apodo||"",PER_FOTO:e.foto||null,PER_VIGENTE:e.vigente===void 0?!0:!!e.vigente,cursos:e.cursos||[],historial:e.historial||[]})})},exportarExcel(){const t=this.personasFiltradas.map(r=>({Nombre:r.nombre,RUT:r.rut,Email:r.email,Rol:r.rol,Rama:r.rama,Grupo:r.grupo,Estado:r.estado})),e=t.length?Object.keys(t[0]):["Nombre","RUT","Email","Rol","Rama","Grupo","Estado"],n=[];n.push(e.join(","));for(const r of t){const O=e.map(A=>{const i=r[A]??"";return`"${String(i).replace(/"/g,'""')}"`});n.push(O.join(","))}const E=n.join(`\r
`),a=new Blob([E],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(a),d=document.createElement("a");d.href=s,d.setAttribute("download","GestionPersonas.csv"),document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s)},guardarEdicion(){if(!this.personaEditada||!this.personaEditada.rut||!this.personaEditada.nombre){alert("Nombre y RUT son obligatorios");return}this.personaEditada&&(this.personaEditada.PER_FECHA_NAC=this.personaEditada.fecha_nac||this.personaEditada.PER_FECHA_NAC||"",this.personaEditada.PER_DIRECCION=this.personaEditada.direccion||this.personaEditada.PER_DIRECCION||"",this.personaEditada.PER_NOM_EMERGENCIA=this.personaEditada.contacto_emergencia||this.personaEditada.PER_NOM_EMERGENCIA||"",this.personaEditada.PER_FONO_EMERGENCIA=this.personaEditada.telefono_emergencia||this.personaEditada.PER_FONO_EMERGENCIA||"",this.personaEditada.PER_ALERGIA_ENFERMEDAD=this.personaEditada.alergias||this.personaEditada.PER_ALERGIA_ENFERMEDAD||"",this.personaEditada.PER_LIMITACION=this.personaEditada.limitacion||this.personaEditada.PER_LIMITACION||"",this.personaEditada.PER_APODO=this.personaEditada.apodo||this.personaEditada.PER_APODO||"",this.personaEditada.PER_RELIGION=this.personaEditada.religion||this.personaEditada.PER_RELIGION||"",this.personaEditada.PER_TIEMPO_NNAJ=this.personaEditada.tiempo_nnaj||this.personaEditada.PER_TIEMPO_NNAJ||"",this.personaEditada.PER_TIEMPO_ADULTO=this.personaEditada.tiempo_adulto||this.personaEditada.PER_TIEMPO_ADULTO||"",this.personaEditada.PER_VIGENTE=this.personaEditada.vigente===void 0?this.personaEditada.PER_VIGENTE??!0:!!this.personaEditada.vigente);const t=this.personas.findIndex(e=>e.rut===this.personaEditada.rut);if(t!==-1)this.$set?this.$set(this.personas,t,Object.assign({},this.personaEditada)):this.personas.splice(t,1,Object.assign({},this.personaEditada));else{const e=this.personaSeleccionada&&this.personaSeleccionada.rut,n=this.personas.findIndex(E=>E.rut===e);n!==-1&&this.personas.splice(n,1,Object.assign({},this.personaEditada))}if(this.filteredPersonas&&this.filteredPersonas.length){const e=this.filteredPersonas.findIndex(n=>n.rut===this.personaEditada.rut);if(e!==-1)this.filteredPersonas.splice(e,1,Object.assign({},this.personaEditada));else{const n=this.personaSeleccionada&&this.personaSeleccionada.rut,E=this.filteredPersonas.findIndex(a=>a.rut===n);E!==-1&&this.filteredPersonas.splice(E,1,Object.assign({},this.personaEditada))}}this.editModalVisible=!1,this.personaSeleccionada=null,this.personaEditada=null,this.pendingSave=!1},prepararGuardado(){this.pendingSave=!0,this.$nextTick(()=>{const t=document.querySelector(".modal-edit");t&&typeof t.scrollIntoView=="function"&&t.scrollIntoView({behavior:"smooth",block:"center"})})},addHistEntry(){if(!this.personaEditada)return;const t=(this.newHistEntry.fecha||"").trim(),e=(this.newHistEntry.descripcion||"").trim();if(!t||!e){alert("Fecha y descripciÃ³n son obligatorias para agregar al historial");return}this.personaEditada.historial=this.personaEditada.historial||[],this.personaEditada.historial.unshift({fecha:t,descripcion:e}),this.newHistEntry={fecha:"",descripcion:""}}}},K={class:"gestion-personas"},W={class:"filtros"},$={class:"filtros-left"},ee={class:"filtros-right"},oe={key:0,class:"filtro-activo",role:"status","aria-live":"polite"},ae={class:"main-area"},ie={key:0,class:"table-wrapper"},te={"data-label":"Nombre"},ne={"data-label":"RUT"},se={"data-label":"Email"},re={"data-label":"Rol"},le={"data-label":"Rama"},de={"data-label":"Grupo"},ce={"data-label":"Estado"},ue={key:0,class:"placeholder-row"},pe={key:1,class:"no-filtro",style:{padding:"32px","text-align":"center",color:"#666"}},me={class:"modal-edit"},Ee={class:"modal-header"},Oe={class:"header-actions"},Re={class:"modal-tabs"},Ae={class:"row"},fe={class:"row"},Ie={class:"row"},he={class:"row"},Ne={class:"row"},Pe={class:"row"},ge={class:"row"},_e={class:"row"},be={class:"row"},Se={class:"row"},Ce={class:"row"},Te={class:"row"},ve={class:"row"},Ue={class:"row"},Ve={class:"row"},Me={class:"row"},Le={class:"row"},Ge={class:"row"},ye={key:1,class:"historial-panel"},De={class:"hist-list"},Be={key:0};function we(t,e,n,E,a,s){const d=P("InputBase"),r=P("BaseSelect"),O=P("BaseButton"),A=P("BaseModal");return l(),c("div",K,[o("div",W,[o("div",$,[R(d,{modelValue:a.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=i=>a.searchQuery=i),placeholder:"Buscar por nombre, RUT, email...",onKeydown:L(s.filtrar,["enter"])},null,8,["modelValue","onKeydown"]),R(r,{modelValue:a.selectedRole,"onUpdate:modelValue":e[1]||(e[1]=i=>a.selectedRole=i),options:a.roleOptions,placeholder:"Todos los roles"},null,8,["modelValue","options"]),R(r,{modelValue:a.selectedCourse,"onUpdate:modelValue":e[2]||(e[2]=i=>a.selectedCourse=i),options:a.courseOptions,placeholder:"Todos los cursos"},null,8,["modelValue","options"]),R(r,{modelValue:a.selectedRama,"onUpdate:modelValue":e[3]||(e[3]=i=>a.selectedRama=i),options:a.ramaOptions,placeholder:"Todas las ramas"},null,8,["modelValue","options"])]),o("div",ee,[R(O,{class:"btn-search",variant:"primary",onClick:s.filtrar},{default:N(()=>[...e[26]||(e[26]=[I("ðŸ”Ž Buscar",-1)])]),_:1},8,["onClick"]),R(O,{class:"btn-export",variant:"secondary",onClick:s.exportarExcel},{default:N(()=>[...e[27]||(e[27]=[I("ðŸ“Š Exportar",-1)])]),_:1},8,["onClick"])])]),a.selectedRole?(l(),c("div",oe,p(s.filtroMensaje),1)):f("",!0),o("div",ae,[a.filtroAplicado?(l(),c("div",ie,[o("table",null,[e[30]||(e[30]=o("thead",null,[o("tr",null,[o("th",null,"Nombre"),o("th",null,"RUT"),o("th",null,"Email"),o("th",null,"Rol"),o("th",null,"Rama"),o("th",null,"Grupo"),o("th",null,"Estado"),o("th",null,"Acciones")])],-1)),o("tbody",null,[(l(!0),c(_,null,b(s.personasFiltradas,i=>(l(),c("tr",{key:i.rut},[o("td",te,p(i.nombre),1),o("td",ne,p(i.rut),1),o("td",se,p(i.email),1),o("td",re,p(i.rol),1),o("td",le,p(i.rama),1),o("td",de,p(i.grupo),1),o("td",ce,[o("span",{class:g(["estado",i.estado.toLowerCase()])},p(i.estado),3)]),o("td",null,[R(O,{class:"editar btn-edit",variant:"secondary",onClick:h=>s.abrirModal(i)},{default:N(()=>[...e[28]||(e[28]=[I("âœï¸ Ver / Editar",-1)])]),_:1},8,["onClick"])])]))),128)),s.personasFiltradas.length===0?(l(),c("tr",ue,[...e[29]||(e[29]=[o("td",{"data-label":"Nombre",colspan:"8"},"No hay participantes para mostrar",-1)])])):f("",!0)])])])):(l(),c("div",pe,' Aplica filtros y presiona "Buscar" para ver la lista de personas. ')),R(A,{modelValue:a.editModalVisible,"onUpdate:modelValue":e[25]||(e[25]=i=>a.editModalVisible=i),onClose:s.cancelarEdicion},{default:N(()=>[o("div",me,[o("header",Ee,[o("h3",null,"Ver / Editar - "+p(a.personaEditada?.nombre||""),1),o("div",Oe,[a.pendingSave?(l(),S(O,{key:1,class:"btn-confirm",type:"button",variant:"success",onClick:s.guardarEdicion},{default:N(()=>[...e[32]||(e[32]=[I("âœ… Confirmar",-1)])]),_:1},8,["onClick"])):(l(),S(O,{key:0,class:"btn-save",type:"button",variant:"primary",onClick:s.prepararGuardado},{default:N(()=>[...e[31]||(e[31]=[I("ðŸ’¾ Guardar",-1)])]),_:1},8,["onClick"]))])]),o("div",Re,[o("button",{class:g({active:a.modalTab==="info"}),onClick:e[4]||(e[4]=i=>a.modalTab="info")},"Info",2),o("button",{class:g({active:a.modalTab==="hist"}),onClick:e[5]||(e[5]=i=>a.modalTab="hist")},"Historial",2)]),a.modalTab==="info"?(l(),c("form",{key:0,onSubmit:e[24]||(e[24]=G((...i)=>s.guardarEdicion&&s.guardarEdicion(...i),["prevent"])),class:"modal-form"},[o("div",Ae,[e[33]||(e[33]=o("label",null,"Nombre",-1)),u(o("input",{"onUpdate:modelValue":e[6]||(e[6]=i=>a.personaEditada.nombre=i),required:""},null,512),[[m,a.personaEditada.nombre]])]),o("div",fe,[e[34]||(e[34]=o("label",null,"RUT",-1)),u(o("input",{"onUpdate:modelValue":e[7]||(e[7]=i=>a.personaEditada.rut=i),required:""},null,512),[[m,a.personaEditada.rut]])]),o("div",Ie,[e[35]||(e[35]=o("label",null,"Email",-1)),u(o("input",{"onUpdate:modelValue":e[8]||(e[8]=i=>a.personaEditada.email=i),type:"email"},null,512),[[m,a.personaEditada.email]])]),o("div",he,[e[36]||(e[36]=o("label",null,"TelÃ©fono",-1)),u(o("input",{"onUpdate:modelValue":e[9]||(e[9]=i=>a.personaEditada.telefono=i)},null,512),[[m,a.personaEditada.telefono]])]),o("div",Ne,[e[37]||(e[37]=o("label",null,"ProfesiÃ³n",-1)),u(o("input",{"onUpdate:modelValue":e[10]||(e[10]=i=>a.personaEditada.profesion=i)},null,512),[[m,a.personaEditada.profesion]])]),o("div",Pe,[e[38]||(e[38]=o("label",null,"Fecha Nac.",-1)),u(o("input",{"onUpdate:modelValue":e[11]||(e[11]=i=>a.personaEditada.fecha_nac=i),type:"date"},null,512),[[m,a.personaEditada.fecha_nac]])]),o("div",ge,[e[39]||(e[39]=o("label",null,"DirecciÃ³n",-1)),u(o("input",{"onUpdate:modelValue":e[12]||(e[12]=i=>a.personaEditada.direccion=i)},null,512),[[m,a.personaEditada.direccion]])]),o("div",_e,[e[40]||(e[40]=o("label",null,"Contacto Emerg.",-1)),u(o("input",{"onUpdate:modelValue":e[13]||(e[13]=i=>a.personaEditada.contacto_emergencia=i)},null,512),[[m,a.personaEditada.contacto_emergencia]])]),o("div",be,[e[41]||(e[41]=o("label",null,"Tel. Emerg.",-1)),u(o("input",{"onUpdate:modelValue":e[14]||(e[14]=i=>a.personaEditada.telefono_emergencia=i)},null,512),[[m,a.personaEditada.telefono_emergencia]])]),o("div",Se,[e[42]||(e[42]=o("label",null,"Alergias",-1)),u(o("input",{"onUpdate:modelValue":e[15]||(e[15]=i=>a.personaEditada.alergias=i)},null,512),[[m,a.personaEditada.alergias]])]),o("div",Ce,[e[43]||(e[43]=o("label",null,"LimitaciÃ³n",-1)),u(o("input",{"onUpdate:modelValue":e[16]||(e[16]=i=>a.personaEditada.limitacion=i)},null,512),[[m,a.personaEditada.limitacion]])]),o("div",Te,[e[44]||(e[44]=o("label",null,"Apodo",-1)),u(o("input",{"onUpdate:modelValue":e[17]||(e[17]=i=>a.personaEditada.apodo=i)},null,512),[[m,a.personaEditada.apodo]])]),o("div",ve,[e[45]||(e[45]=o("label",null,"ReligiÃ³n",-1)),u(o("input",{"onUpdate:modelValue":e[18]||(e[18]=i=>a.personaEditada.religion=i)},null,512),[[m,a.personaEditada.religion]])]),o("div",Ue,[e[46]||(e[46]=o("label",null,"Tiempo NNAJ",-1)),u(o("input",{"onUpdate:modelValue":e[19]||(e[19]=i=>a.personaEditada.tiempo_nnaj=i)},null,512),[[m,a.personaEditada.tiempo_nnaj]])]),o("div",Ve,[e[47]||(e[47]=o("label",null,"Tiempo Adulto",-1)),u(o("input",{"onUpdate:modelValue":e[20]||(e[20]=i=>a.personaEditada.tiempo_adulto=i)},null,512),[[m,a.personaEditada.tiempo_adulto]])]),o("div",Me,[e[49]||(e[49]=o("label",null,"Vigente",-1)),u(o("select",{"onUpdate:modelValue":e[21]||(e[21]=i=>a.personaEditada.vigente=i)},[...e[48]||(e[48]=[o("option",{value:!0},"Si",-1),o("option",{value:!1},"No",-1)])],512),[[y,a.personaEditada.vigente]])]),o("div",Le,[e[50]||(e[50]=o("label",null,"Rol",-1)),R(r,{modelValue:a.personaEditada.rol,"onUpdate:modelValue":e[22]||(e[22]=i=>a.personaEditada.rol=i),options:a.roleOptions},null,8,["modelValue","options"])]),o("div",Ge,[e[51]||(e[51]=o("label",null,"Rama",-1)),R(r,{modelValue:a.personaEditada.rama,"onUpdate:modelValue":e[23]||(e[23]=i=>a.personaEditada.rama=i),options:a.ramaOptions},null,8,["modelValue","options"])])],32)):(l(),c("div",ye,[o("div",De,[(a.personaEditada.historial||[]).length===0?(l(),c("div",Be,"No hay participaciones previas.")):f("",!0),o("ul",null,[(l(!0),c(_,null,b(a.personaEditada.historial||[],(i,h)=>(l(),c("li",{key:h},[o("strong",null,p(i.fecha),1),I(": "+p(i.descripcion),1)]))),128))])])]))])]),_:1},8,["modelValue","onClose"])])])}const xe=C(Y,[["render",we],["__scopeId","data-v-e1b5fdec"]]);export{xe as default};
